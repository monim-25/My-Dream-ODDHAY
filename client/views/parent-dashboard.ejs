<!DOCTYPE html>
<html class="light" lang="bn">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>‡¶Ö‡¶≠‡¶ø‡¶≠‡¶æ‡¶¨‡¶ï ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶° | ODDHAY</title>
    <%- include('partials/head') %>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body class="bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-100 flex min-h-screen">
    <!-- Sidebar -->
    <aside
        class="w-72 border-r border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 hidden lg:flex flex-col sticky top-0 h-screen transition-all">
        <div class="p-8">
            <a href="/" class="flex items-center gap-2 mb-12 group">
                <div class="text-primary transform group-hover:rotate-12 transition-transform duration-300">
                    <svg class="size-8" fill="none" viewbox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
                        <path d="M4 4H17.3334V17.3334H30.6666V30.6666H44V44H4V4Z" fill="currentColor"></path>
                    </svg>
                </div>
                <h1 class="text-2xl font-black tracking-tighter">ODDHAY</h1>
            </a>
            <nav class="space-y-2">
                <p class="text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] mb-4 px-4">‡¶™‡ßç‡¶Ø‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü ‡¶™‡ßã‡¶∞‡ßç‡¶ü‡¶æ‡¶≤
                </p>
                <a href="/parent/dashboard"
                    class="flex items-center gap-3 px-4 py-3.5 rounded-2xl bg-primary text-white shadow-lg shadow-primary/20 font-bold text-sm">
                    <span class="material-symbols-outlined text-xl">family_restroom</span> ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞ ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤
                </a>
            </nav>
        </div>
        <div class="mt-auto p-8 border-t border-slate-100 dark:border-slate-800">
            <a href="/logout"
                class="flex items-center gap-3 px-4 py-3.5 rounded-2xl text-red-500 hover:bg-red-50 dark:hover:bg-red-500/10 font-black text-sm transition-all">
                <span class="material-symbols-outlined text-xl">logout</span> ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü
            </a>
        </div>
    </aside>

    <main class="flex-1 p-4 md:p-8 lg:p-12 max-w-7xl mx-auto w-full">
        <header class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6 mb-12 reveal">
            <div>
                <h2 class="text-3xl font-black mb-1">‡¶Ö‡¶≠‡¶ø‡¶≠‡¶æ‡¶¨‡¶ï ‡¶™‡ßã‡¶∞‡ßç‡¶ü‡¶æ‡¶≤ üëã</h2>
                <p class="text-slate-500 font-bold text-sm">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶®‡ßç‡¶§‡¶æ‡¶®‡ßá‡¶∞ ‡¶™‡ßú‡¶æ‡¶∂‡ßã‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶ó‡ßç‡¶∞‡¶ó‡¶§‡¶ø ‡¶™‡¶∞‡ßç‡¶Ø‡¶¨‡ßá‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
            </div>
            <div class="flex items-center gap-4">
                <button
                    class="size-12 rounded-2xl bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-sm flex items-center justify-center text-slate-500 hover:text-primary transition-all"
                    onclick="document.documentElement.classList.toggle('dark')">
                    <span class="material-symbols-outlined block dark:hidden">dark_mode</span>
                    <span class="material-symbols-outlined hidden dark:block text-amber-400">light_mode</span>
                </button>
            </div>
        </header>

        <!-- Tool Bar -->
        <section class="mb-10 flex flex-wrap gap-4 items-center justify-between reveal delay-100">
            <div class="flex flex-wrap gap-3">
                <% if(confirmedChildren && confirmedChildren.length> 0) { %>
                    <% confirmedChildren.forEach((child, index)=> { %>
                        <div
                            class="px-6 py-2.5 rounded-2xl <%= index === 0 ? 'bg-primary text-white shadow-lg shadow-primary/20' : 'bg-white dark:bg-slate-800 text-slate-500 border border-slate-100 dark:border-slate-800' %> font-black text-xs uppercase tracking-widest cursor-pointer hover:scale-105 transition-all">
                            <%= child.name %>
                        </div>
                        <% }); %>
                            <% } %>
            </div>
            <button onclick="document.getElementById('add-child-modal').classList.remove('hidden')"
                class="px-6 py-3 rounded-2xl bg-white dark:bg-slate-800 border-2 border-dashed border-primary/30 text-primary font-black text-xs uppercase tracking-widest hover:border-primary hover:bg-primary/5 transition-all flex items-center gap-2">
                <span class="material-symbols-outlined">person_add</span> ‡¶∏‡¶®‡ßç‡¶§‡¶æ‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®
            </button>
        </section>

        <!-- Progress Overview -->
        <% if(confirmedChildren && confirmedChildren.length> 0) { %>
            <% confirmedChildren.forEach((child, cIdx)=> { %>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-16 reveal delay-200">
                    <div class="lg:col-span-2 space-y-8">
                        <div class="card-smart">
                            <h3 class="text-xl font-black mb-10 flex items-center justify-between">
                                <span>‡¶™‡ßú‡¶æ‡¶∂‡ßã‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶ó‡ßç‡¶∞‡ßá‡¶∏ - <%= child.name %></span>
                                <span class="text-xs font-black text-primary bg-primary/10 px-4 py-1.5 rounded-full">
                                    <%= child.completedLessons.length %> ‡¶ü‡¶ø ‡¶≤‡ßá‡¶∏‡¶® ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®
                                </span>
                            </h3>
                            <div class="relative h-64">
                                <canvas id="chart-<%= cIdx %>"></canvas>
                            </div>
                        </div>

                        <div class="card-smart">
                            <h3 class="text-xl font-black mb-8">‡¶∏‡¶æ‡¶Æ‡ßç‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï ‡¶ï‡ßÅ‡¶á‡¶ú ‡¶´‡¶≤‡¶æ‡¶´‡¶≤</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <% if(child.quizResults && child.quizResults.length> 0) { %>
                                    <% child.quizResults.reverse().slice(0, 4).forEach(result=> { %>
                                        <div
                                            class="flex items-center justify-between p-5 bg-slate-50 dark:bg-slate-800/50 rounded-2xl border border-slate-100 dark:border-slate-800 group hover:border-primary transition-all">
                                            <div class="flex items-center gap-4">
                                                <div
                                                    class="size-12 rounded-xl bg-amber-500/10 text-amber-500 flex items-center justify-center font-black">
                                                    <%= (result.score/result.total * 100).toFixed(0) %>%
                                                </div>
                                                <div>
                                                    <p class="font-black text-sm truncate max-w-[120px]">
                                                        <%= result.quiz ? result.quiz.title : 'Quiz' %>
                                                    </p>
                                                    <p
                                                        class="text-[10px] text-slate-400 font-bold uppercase tracking-tight">
                                                        <%= new Date(result.date).toLocaleDateString('bn-BD') %>
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="text-right">
                                                <p class="font-black text-primary text-lg">
                                                    <%= result.score %>/<%= result.total %>
                                                </p>
                                            </div>
                                        </div>
                                        <% }); %>
                                            <% } else { %>
                                                <div
                                                    class="col-span-full py-10 text-center border-2 border-dashed border-slate-100 dark:border-slate-800 rounded-3xl">
                                                    <p class="text-slate-400 font-bold text-sm italic">‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ
                                                        ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡ßü‡¶®‡¶ø‡•§</p>
                                                </div>
                                                <% } %>
                            </div>
                        </div>
                    </div>

                    <div class="lg:col-span-1">
                        <div class="card-smart bg-primary !text-white !p-10 sticky top-28 overflow-hidden group">
                            <div
                                class="absolute -right-10 -bottom-10 size-40 bg-white/10 rounded-full blur-3xl group-hover:scale-150 transition-all duration-700">
                            </div>
                            <h3 class="text-2xl font-black mb-6">‡¶ü‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶´‡¶ø‡¶°‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï</h3>
                            <div class="space-y-6 relative z-10">
                                <div class="p-6 bg-white/10 rounded-2xl border border-white/20 backdrop-blur-md">
                                    <p class="text-sm italic font-medium leading-relaxed">"<%= child.name %> ‡¶ó‡¶§ ‡¶∏‡¶™‡ßç‡¶§‡¶æ‡¶π‡ßá
                                            ‡¶ñ‡ßÅ‡¶¨ ‡¶≠‡¶æ‡¶≤‡ßã ‡¶ï‡¶∞‡ßá‡¶õ‡ßá, ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶ï‡¶∞‡ßá ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶® ‡¶ì ‡¶ó‡¶£‡¶ø‡¶§ ‡¶§‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶ó‡ßç‡¶∞‡ßá‡¶∏ ‡¶ö‡ßã‡¶ñ‡ßá ‡¶™‡ßú‡¶æ‡¶∞ ‡¶Æ‡¶§‡ßã‡•§"</p>
                                    <p class="text-[10px] font-black mt-4 opacity-60 uppercase tracking-widest">‚Äî ‡¶Æ‡ßá‡¶®‡ßç‡¶ü‡¶∞
                                        ‡¶ü‡¶ø‡¶∂‡¶æ‡¶∞‡ßç‡¶ü ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</p>
                                </div>
                                <button
                                    class="w-full py-4 bg-white text-primary rounded-2xl font-black text-sm shadow-xl hover:scale-[1.02] transition-all">‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï‡¶ï‡ßá
                                    ‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ ‡¶™‡¶æ‡¶†‡¶æ‡¶®</button>
                            </div>
                        </div>
                    </div>
                </div>

                <script>
                    const ctx<%= cIdx %> = document.getElementById('chart-<%= cIdx %>').getContext('2d');
                    new Chart(ctx <%= cIdx %>, {
                        type: 'line',
                        data: {
                            labels: ['‡¶∂‡¶®‡¶ø‡¶¨‡¶æ‡¶∞', '‡¶∞‡¶¨‡¶ø‡¶¨‡¶æ‡¶∞', '‡¶∏‡ßã‡¶Æ‡¶¨‡¶æ‡¶∞', '‡¶Æ‡¶ô‡ßç‡¶ó‡¶≤‡¶¨‡¶æ‡¶∞', '‡¶¨‡ßÅ‡¶ß‡¶¨‡¶æ‡¶∞', '‡¶¨‡ßÉ‡¶π‡¶∏‡ßç‡¶™‡¶§‡¶ø‡¶¨‡¶æ‡¶∞', '‡¶∂‡ßÅ‡¶ï‡ßç‡¶∞‡¶¨‡¶æ‡¶∞'],
                            datasets: [{
                                label: '‡¶™‡ßú‡¶æ‡¶∂‡ßã‡¶®‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßü (‡¶ò‡¶£‡ßç‡¶ü‡¶æ)',
                                data: [2, 3, 2.5, 4, 3, 5, 4],
                                borderColor: '#137fec',
                                backgroundColor: 'rgba(19, 127, 236, 0.1)',
                                fill: true,
                                tension: 0.4,
                                borderWidth: 4,
                                pointRadius: 5,
                                pointBackgroundColor: '#fff',
                                pointBorderColor: '#137fec',
                                pointBorderWidth: 2
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: { legend: { display: false } },
                            scales: {
                                y: { beginAtZero: true, grid: { display: false }, ticks: { font: { weight: 'bold' } } },
                                x: { grid: { display: false }, ticks: { font: { weight: 'bold' } } }
                            }
                        }
                    });
                </script>
                <% }); %>
                    <% } else { %>
                        <div class="py-24 text-center card-smart border-dashed border-2 reveal delay-200">
                            <div
                                class="size-24 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center mx-auto mb-8 text-slate-300">
                                <span class="material-symbols-outlined text-6xl">family_restroom</span>
                            </div>
                            <h3 class="text-2xl font-black mb-4">‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡¶®‡ßç‡¶§‡¶æ‡¶® ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶®‡ßá‡¶á</h3>
                            <p class="text-slate-500 font-bold max-w-sm mx-auto mb-10">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶®‡ßç‡¶§‡¶æ‡¶®‡ßá‡¶∞ ‡¶ì‡¶ß‡ßç‡¶Ø‡¶æ‡ßü (ODDHAY)
                                ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶¶‡¶ø‡ßü‡ßá ‡¶§‡¶æ‡¶ï‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
                            <button onclick="document.getElementById('add-child-modal').classList.remove('hidden')"
                                class="btn-primary">‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶ñ‡¶®‡¶á</button>
                        </div>
                        <% } %>
    </main>

    <!-- Add Child Modal -->
    <div id="add-child-modal"
        class="hidden fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-[2000] flex items-center justify-center p-6">
        <div
            class="max-w-md w-full bg-white dark:bg-slate-950 rounded-[3rem] p-10 md:p-14 shadow-2xl relative reveal active">
            <button onclick="document.getElementById('add-child-modal').classList.add('hidden')"
                class="absolute top-10 right-10 size-10 rounded-xl bg-slate-50 dark:bg-slate-800 flex items-center justify-center text-slate-400 hover:text-red-500 transition-all border border-slate-100 dark:border-slate-800">
                <span class="material-symbols-outlined">close</span>
            </button>
            <h3 class="text-2xl font-black mb-2 text-center">‡¶∏‡¶®‡ßç‡¶§‡¶æ‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
            <p class="text-center text-slate-500 mb-10 text-sm font-bold leading-relaxed">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶®‡ßç‡¶§‡¶æ‡¶®‡ßá‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü
                ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶ï‡¶∞‡¶§‡ßá ‡¶§‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ‡¶ü‡¶ø ‡¶¶‡¶ø‡¶®‡•§</p>
            <form action="/parent/add-child" method="POST" class="space-y-6">
                <div class="space-y-2">
                    <label class="block text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1">‡¶á‡¶Æ‡ßá‡¶á‡¶≤
                        ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ</label>
                    <input type="email" name="childEmail" placeholder="child@example.com"
                        class="w-full px-6 h-14 rounded-2xl bg-slate-50 dark:bg-slate-900 border-none text-base font-black italic shadow-inner"
                        required>
                </div>
                <button type="submit"
                    class="btn-primary w-full h-16 !rounded-2xl !text-base shadow-2xl shadow-primary/30 mt-4">‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡ßç‡¶ü
                    ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            </form>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => entry.isIntersecting && entry.target.classList.add('active'));
            }, { threshold: 0.1 });
            document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
        });
    </script>
</body>

</html>