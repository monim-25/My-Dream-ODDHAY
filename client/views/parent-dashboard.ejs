<!DOCTYPE html>
<html class="light" lang="bn">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>‡¶Ö‡¶≠‡¶ø‡¶≠‡¶æ‡¶¨‡¶ï ‡¶™‡ßã‡¶∞‡ßç‡¶ü‡¶æ‡¶≤ | ‡¶Ö‡¶ß‡ßç‡¶Ø‡¶æ‡ßü</title>
    <%- include('partials/head') %>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <style>
            .child-tab-active {
                background: #137fec;
                color: white;
                box-shadow: 0 10px 20px -5px rgba(19, 127, 236, 0.3);
            }

            .sidebar-item-active {
                background: rgba(19, 127, 236, 0.1);
                color: #137fec;
            }
        </style>
</head>

<body class="bg-slate-50 dark:bg-[#0f172a] text-slate-900 dark:text-slate-100 min-h-screen">
    <div class="flex flex-col md:flex-row min-h-screen">
        <!-- Sidebar -->
        <aside id="sidebar"
            class="fixed inset-y-0 left-0 w-72 bg-white dark:bg-slate-900 border-r border-slate-200 dark:border-slate-800 p-8 flex flex-col z-[4000] -translate-x-full md:relative md:translate-x-0 transition-transform duration-300">
            <div class="flex items-center justify-between mb-12">
                <a href="/" class="flex items-center gap-3 group">
                    <div class="text-primary transform group-hover:rotate-12 transition-transform duration-300">
                        <svg class="size-10" fill="none" viewbox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
                            <path d="M4 4H17.3334V17.3334H30.6666V30.6666H44V44H4V4Z" fill="currentColor"></path>
                        </svg>
                    </div>
                    <h1 class="text-2xl font-black tracking-tighter">‡¶Ö‡¶ß‡ßç‡¶Ø‡¶æ‡ßü</h1>
                </a>
                <button class="md:hidden text-slate-400" onclick="toggleSidebar()">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>

            <nav class="space-y-4 flex-1">
                <p class="text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] mb-4 px-4">‡¶™‡ßç‡¶Ø‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü
                    ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏‡ßá‡¶∏</p>
                <a href="/parent/dashboard"
                    class="flex items-center gap-3 px-6 py-4 rounded-2xl sidebar-item-active font-black transition-all">
                    <span class="material-symbols-outlined">family_restroom</span> ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞ ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤
                </a>
                <a href="/dashboard"
                    class="flex items-center gap-3 px-6 py-4 rounded-2xl text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800/50 font-bold transition-all">
                    <span class="material-symbols-outlined">grid_view</span> ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°
                </a>
            </nav>

            <div class="pt-8 border-t border-slate-100 dark:border-slate-800">
                <a href="/logout"
                    class="flex items-center gap-3 px-6 py-4 rounded-2xl text-red-500 hover:bg-red-50 dark:hover:bg-red-500/10 font-black transition-all">
                    <span class="material-symbols-outlined">logout</span> ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü
                </a>
            </div>
        </aside>

        <!-- Main Area -->
        <main class="flex-1 p-6 md:p-12 max-w-7xl mx-auto w-full">
            <!-- Header -->
            <header class="flex flex-col md:flex-row justify-between items-start md:items-center gap-8 mb-12">
                <div class="reveal flex items-center justify-between w-full md:w-auto">
                    <div>
                        <h2 class="text-4xl font-black mb-2 italic">‡¶™‡ßç‡¶Ø‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü ‡¶™‡ßã‡¶∞‡ßç‡¶ü‡¶æ‡¶≤ üëã</h2>
                        <p class="text-slate-500 font-bold text-sm">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶®‡ßç‡¶§‡¶æ‡¶®‡ßá‡¶∞ ‡¶™‡ßú‡¶æ‡¶∂‡ßã‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶ó‡ßç‡¶∞‡¶ó‡¶§‡¶ø ‡¶è‡¶ï ‡¶®‡¶ú‡¶∞‡ßá ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®‡•§</p>
                    </div>
                    <!-- Hamburger for Mobile Sidebar -->
                    <button
                        class="md:hidden size-12 flex items-center justify-center rounded-2xl bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-sm"
                        onclick="toggleSidebar()">
                        <span class="material-symbols-outlined">menu</span>
                    </button>
                </div>
                <div class="flex items-center gap-4 reveal self-end md:self-auto">
                    <!-- Three Dot Menu -->
                    <div class="relative">
                        <button id="menu-btn"
                            class="size-14 rounded-2xl bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-sm flex items-center justify-center text-slate-400 hover:text-primary transition-all">
                            <span class="material-symbols-outlined">more_vert</span>
                        </button>
                        <!-- Dropdown -->
                        <div id="dropdown-menu"
                            class="hidden absolute right-0 mt-3 w-56 bg-white dark:bg-slate-900 rounded-[2rem] shadow-2xl border border-slate-100 dark:border-slate-800 py-4 z-[100] animate-pop">
                            <a href="/profile"
                                class="flex items-center gap-3 px-6 py-3 text-sm font-black text-slate-500 hover:text-primary hover:bg-primary/5 transition-all">
                                <span class="material-symbols-outlined text-xl">person</span> ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤
                            </a>
                            <a href="/settings"
                                class="flex items-center gap-3 px-6 py-3 text-sm font-black text-slate-500 hover:text-primary hover:bg-primary/5 transition-all">
                                <span class="material-symbols-outlined text-xl">settings</span> ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏
                            </a>
                            <a href="/dashboard"
                                class="flex items-center gap-3 px-6 py-3 text-sm font-black text-slate-500 hover:text-primary hover:bg-primary/5 transition-all">
                                <span class="material-symbols-outlined text-xl">grid_view</span> ‡¶∏‡ßç‡¶ü‡ßÅ‡¶°‡ßá‡¶®‡ßç‡¶ü ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤
                            </a>
                            <div class="h-px bg-slate-100 dark:bg-slate-800 my-2 mx-6"></div>
                            <a href="/logout"
                                class="flex items-center gap-3 px-6 py-3 text-sm font-black text-red-500 hover:bg-red-50 dark:hover:bg-red-500/10 transition-all">
                                <span class="material-symbols-outlined text-xl">logout</span> ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü
                            </a>
                        </div>
                    </div>
                    <button
                        class="size-14 rounded-2xl bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-sm flex items-center justify-center text-slate-400 hover:text-primary transition-all"
                        onclick="document.documentElement.classList.toggle('dark')">
                        <span class="material-symbols-outlined">light_mode</span>
                    </button>
                    <div
                        class="size-14 rounded-2xl bg-gradient-to-br from-primary to-blue-600 text-white flex items-center justify-center font-black text-xl shadow-xl shadow-primary/20">
                        <%= user ? user.name[0] : 'P' %>
                    </div>
                </div>
            </header>

            <% let allAlerts=[]; if (confirmedChildren) { confirmedChildren.forEach(child=> {
                // Quiz alerts
                child.quizResults.forEach(res => {
                allAlerts.push({
                student: child.name,
                type: 'quiz',
                title: res.quiz ? res.quiz.title : '‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®',
                description: `${res.score}/${res.total} ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶™‡ßá‡ßü‡ßá‡¶õ‡ßá‡•§`,
                date: res.date,
                icon: 'quiz',
                color: 'amber'
                });
                });
                // Course enrollment alerts
                if (child.enrolledCourses) {
                child.enrolledCourses.forEach(en => {
                allAlerts.push({
                student: child.name,
                type: 'course',
                title: en.course ? en.course.title : '‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡ßã‡¶∞‡ßç‡¶∏',
                description: `‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡ßã‡¶∞‡ßç‡¶∏‡ßá ‡¶è‡¶®‡¶∞‡ßã‡¶≤ ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡•§`,
                date: en.enrolledAt || new Date(),
                icon: 'auto_stories',
                color: 'blue'
                });
                });
                }
                });
                }
                allAlerts.sort((a, b) => new Date(b.date) - new Date(a.date));
                const recentAlerts = allAlerts.slice(0, 3);
                %>

                <!-- Alerts Grid -->
                <% if (recentAlerts.length> 0) { %>
                    <section class="mb-16">
                        <h3
                            class="text-xs font-black text-slate-400 uppercase tracking-[0.3em] mb-8 ml-2 flex items-center gap-3">
                            <span class="size-2 rounded-full bg-red-500 animate-pulse"></span> ‡¶∞‡¶ø‡ßü‡ßá‡¶≤-‡¶ü‡¶æ‡¶á‡¶Æ ‡¶è‡¶≤‡¶æ‡¶∞‡ßç‡¶ü
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <% recentAlerts.forEach(alert=> { %>
                                <div
                                    class="glass-card p-6 border-slate-200/50 flex gap-4 hover:translate-y-[-5px] transition-all">
                                    <div
                                        class="size-12 rounded-2xl bg-<%= alert.color %>-500/10 text-<%= alert.color %>-500 flex items-center justify-center shrink-0">
                                        <span class="material-symbols-outlined">
                                            <%= alert.icon %>
                                        </span>
                                    </div>
                                    <div class="overflow-hidden">
                                        <p class="text-[10px] font-black text-slate-400 uppercase truncate mb-1">
                                            <%= alert.student %>
                                        </p>
                                        <h4 class="font-black text-sm text-slate-800 dark:text-slate-100 truncate">
                                            <%= alert.title %>
                                        </h4>
                                        <p class="text-xs font-bold text-slate-500 mt-1">
                                            <%= alert.description %>
                                        </p>
                                    </div>
                                </div>
                                <% }) %>
                        </div>
                    </section>
                    <% } %>

                        <!-- Child Selector & Action -->
                        <section class="flex flex-wrap gap-6 items-center justify-between mb-12">
                            <div class="flex flex-wrap gap-4 overflow-x-auto pb-2 scrollbar-none">
                                <% if(confirmedChildren && confirmedChildren.length> 0) { %>
                                    <% confirmedChildren.forEach((child, idx)=> { %>
                                        <button onclick="switchChild(<%= idx %>)" id="btn-child-<%= idx %>"
                                            class="child-toggle px-8 py-4 rounded-2xl font-black text-xs uppercase tracking-widest whitespace-nowrap transition-all <%= idx === 0 ? 'child-tab-active' : 'bg-white dark:bg-slate-900 text-slate-400 border border-slate-100 dark:border-slate-800' %>">
                                            <%= child.name %>
                                        </button>
                                        <% }) %>
                                            <% } %>
                            </div>
                            <button onclick="document.getElementById('add-child-modal').classList.remove('hidden')"
                                class="px-8 py-4 rounded-2xl bg-white dark:bg-slate-900 border-2 border-dashed border-primary/30 text-primary font-black text-xs uppercase tracking-widest hover:border-primary hover:bg-primary/5 transition-all flex items-center gap-3">
                                <span class="material-symbols-outlined text-sm">person_add</span> ‡¶∏‡¶®‡ßç‡¶§‡¶æ‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®
                            </button>
                        </section>

                        <!-- Active Child View -->
                        <% if(confirmedChildren && confirmedChildren.length> 0) { %>
                            <div id="children-container">
                                <% confirmedChildren.forEach((child, cIdx)=> { %>
                                    <div id="child-view-<%= cIdx %>"
                                        class="child-view <%= cIdx === 0 ? '' : 'hidden' %> space-y-12">
                                        <!-- Stats Grid -->
                                        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                                            <div
                                                class="md:col-span-2 card-smart p-10 h-80 flex flex-col justify-between">
                                                <h4 class="text-xl font-black">‡¶™‡ßú‡¶æ‡¶∂‡ßã‡¶®‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßü (‡¶∏‡¶æ‡¶™‡ßç‡¶§‡¶æ‡¶π‡¶ø‡¶ï)</h4>
                                                <div class="flex-1 mt-6">
                                                    <canvas id="chart-<%= cIdx %>"></canvas>
                                                </div>
                                            </div>
                                            <div
                                                class="bg-primary p-10 rounded-[3rem] text-white flex flex-col justify-between relative overflow-hidden group">
                                                <span
                                                    class="material-symbols-outlined absolute -top-10 -right-10 text-[150px] opacity-10 group-hover:rotate-12 transition-transform duration-700">timer</span>
                                                <h4 class="text-lg font-bold opacity-80 uppercase tracking-widest">‡¶≤‡ßá‡¶∏‡¶®
                                                    ‡¶∂‡ßá‡¶∑</h4>
                                                <h3 class="text-6xl font-black">
                                                    <%= child.completedLessons.length %>
                                                </h3>
                                                <p
                                                    class="text-xs font-bold bg-white/20 w-fit px-4 py-2 rounded-full mt-4">
                                                    ‡¶ó‡¶§ ‡ß≠ ‡¶¶‡¶ø‡¶®‡ßá +‡ß©</p>
                                            </div>
                                            <div
                                                class="bg-amber-500 p-10 rounded-[3rem] text-white flex flex-col justify-between relative overflow-hidden group">
                                                <span
                                                    class="material-symbols-outlined absolute -top-10 -right-10 text-[150px] opacity-10 group-hover:rotate-12 transition-transform duration-700">stars</span>
                                                <h4 class="text-lg font-bold opacity-80 uppercase tracking-widest">‡¶ó‡ßú
                                                    ‡¶∏‡ßç‡¶ï‡ßã‡¶∞</h4>
                                                <h3 class="text-6xl font-black">
                                                    <% let avg=0; if(child.quizResults.length> 0) {
                                                        avg = (child.quizResults.reduce((acc, r) => acc +
                                                        (r.score/r.total), 0) / child.quizResults.length *
                                                        100).toFixed(0);
                                                        }
                                                        %>
                                                        <%= avg %>%
                                                </h3>
                                                <p
                                                    class="text-xs font-bold bg-white/20 w-fit px-4 py-2 rounded-full mt-4">
                                                    ‡¶Ö‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶Ö‡¶ó‡ßç‡¶∞‡¶ó‡¶§‡¶ø!</p>
                                            </div>
                                        </div>

                                        <!-- Progress Detail -->
                                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-12">
                                            <div class="lg:col-span-2 space-y-10">
                                                <div class="card-smart">
                                                    <h3 class="text-2xl font-black mb-10">‡¶∏‡¶æ‡¶Æ‡ßç‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï ‡¶ï‡ßÅ‡¶á‡¶ú ‡¶´‡¶≤‡¶æ‡¶´‡¶≤‡¶∏‡¶Æ‡ßÇ‡¶π</h3>
                                                    <div class="space-y-4">
                                                        <% if (child.quizResults.length> 0) { %>
                                                            <% child.quizResults.slice().reverse().slice(0,
                                                                5).forEach(res=> { %>
                                                                <div
                                                                    class="flex items-center justify-between p-6 bg-slate-50 dark:bg-slate-800/40 rounded-[2rem] border border-slate-100 dark:border-slate-800 group hover:border-primary transition-all">
                                                                    <div class="flex items-center gap-6">
                                                                        <div
                                                                            class="size-14 rounded-2xl bg-white dark:bg-slate-950 flex items-center justify-center font-black text-primary shadow-sm group-hover:scale-110 transition-transform">
                                                                            <%= (res.score/res.total * 100).toFixed(0)
                                                                                %>%
                                                                        </div>
                                                                        <div>
                                                                            <h5
                                                                                class="font-black text-slate-800 dark:text-slate-100">
                                                                                <%= res.quiz ? res.quiz.title
                                                                                    : '‡¶®‡¶Æ‡ßÅ‡¶®‡¶æ ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ' %>
                                                                            </h5>
                                                                            <p
                                                                                class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-1">
                                                                                <%= new
                                                                                    Date(res.date).toLocaleDateString('bn-BD',
                                                                                    { day: 'numeric' , month: 'long' })
                                                                                    %>
                                                                            </p>
                                                                        </div>
                                                                    </div>
                                                                    <div class="text-right">
                                                                        <p
                                                                            class="text-2xl font-black text-<%= (res.score/res.total) >= 0.8 ? 'emerald-500' : 'amber-500' %>">
                                                                            <%= res.score %>/<%= res.total %>
                                                                        </p>
                                                                    </div>
                                                                </div>
                                                                <% }) %>
                                                                    <% } else { %>
                                                                        <div
                                                                            class="py-16 text-center bg-slate-50 dark:bg-slate-800/10 rounded-[3rem] border-2 border-dashed border-slate-200 dark:border-slate-800">
                                                                            <span
                                                                                class="material-symbols-outlined text-4xl text-slate-300 mb-4">edit_calendar</span>
                                                                            <p class="text-slate-400 font-bold italic">
                                                                                ‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡ßü‡¶®‡¶ø‡•§</p>
                                                                        </div>
                                                                        <% } %>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Right Section -->
                                            <div class="space-y-10">
                                                <div class="card-smart border-primary/20 bg-primary/5">
                                                    <div
                                                        class="size-14 bg-primary text-white rounded-2xl flex items-center justify-center mb-6 shadow-xl shadow-primary/20">
                                                        <span class="material-symbols-outlined">psychology</span>
                                                    </div>
                                                    <h4 class="text-xl font-black mb-4">‡¶Æ‡ßá‡¶®‡ßç‡¶ü‡¶∞ ‡¶´‡¶ø‡¶°‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï</h4>
                                                    <p
                                                        class="text-slate-500 font-bold text-sm leading-relaxed mb-8 italic">
                                                        "<%= child.name %> ‡¶ó‡¶§ ‡¶∏‡¶™‡ßç‡¶§‡¶æ‡¶π‡ßá ‡¶ï‡ßÅ‡¶á‡¶ú‡ßá ‡¶ñ‡ßÅ‡¶¨ ‡¶≠‡¶æ‡¶≤‡ßã ‡¶â‡¶®‡ßç‡¶®‡¶§‡¶ø ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡•§ ‡¶§‡¶æ‡¶∞
                                                            ‡¶ó‡¶£‡¶ø‡¶§ ‡¶ì ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶® ‡¶¨‡¶ø‡¶∑‡ßü‡¶ï ‡¶≤‡ßá‡¶∏‡¶®‡¶ó‡ßÅ‡¶≤‡ßã ‡¶®‡¶ø‡ßü‡¶Æ‡¶ø‡¶§ ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶™‡ßç‡¶∞‡ßü‡ßã‡¶ú‡¶®‡•§"</p>
                                                    <button
                                                        class="w-full h-14 bg-primary text-white rounded-2xl font-black text-xs uppercase tracking-widest hover:scale-105 active:scale-95 transition-all">‡¶™‡¶∞‡¶æ‡¶Æ‡¶∞‡ßç‡¶∂
                                                        ‡¶®‡¶ø‡¶®</button>
                                                </div>

                                                <div class="card-smart">
                                                    <h4 class="text-lg font-black mb-6">‡¶∂‡¶ø‡¶ñ‡¶® ‡¶∏‡ßç‡¶§‡¶∞ (Performance)</h4>
                                                    <div class="space-y-6">
                                                        <% const subjects={}; child.quizResults.forEach(r=> {
                                                            const sub = (r.quiz && r.quiz.course) ?
                                                            r.quiz.course.subject : '‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø';
                                                            if(!subjects[sub]) subjects[sub] = { count: 0, score: 0 };
                                                            subjects[sub].count++;
                                                            subjects[sub].score += (r.score / r.total);
                                                            }); %>
                                                            <% Object.keys(subjects).forEach(sub=> { %>
                                                                <div class="space-y-2">
                                                                    <div class="flex justify-between items-center px-1">
                                                                        <span
                                                                            class="text-xs font-black text-slate-500 uppercase">
                                                                            <%= sub %>
                                                                        </span>
                                                                        <span class="text-xs font-black">
                                                                            <%= (subjects[sub].score /
                                                                                subjects[sub].count * 100).toFixed(0) %>
                                                                                %
                                                                        </span>
                                                                    </div>
                                                                    <div
                                                                        class="h-2 w-full bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden">
                                                                        <div class="h-full bg-primary rounded-full transition-all duration-1000"
                                                                            style="width: <%= (subjects[sub].score / subjects[sub].count * 100) %>%">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <% }) %>
                                                                    <% if(Object.keys(subjects).length===0) { %>
                                                                        <p
                                                                            class="text-xs text-slate-400 font-bold italic text-center py-4">
                                                                            ‡¶§‡¶•‡ßç‡¶Ø ‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£ ‡¶ö‡¶≤‡¶õ‡ßá...</p>
                                                                        <% } %>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <% }) %>
                            </div>
                            <% } else { %>
                                <!-- Empty State -->
                                <div
                                    class="card-smart py-24 text-center border-2 border-dashed flex flex-col items-center justify-center">
                                    <div
                                        class="size-32 bg-slate-100 dark:bg-slate-800 rounded-[3rem] flex items-center justify-center text-slate-300 mb-8 overflow-hidden relative group">
                                        <span
                                            class="material-symbols-outlined text-7xl group-hover:scale-110 transition-transform">group</span>
                                    </div>
                                    <h3 class="text-3xl font-black mb-4">‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡¶®‡ßç‡¶§‡¶æ‡¶® ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶®‡ßá‡¶á</h3>
                                    <p class="text-slate-500 font-bold max-w-sm mb-12">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶®‡ßç‡¶§‡¶æ‡¶®‡ßá‡¶∞ ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®
                                        ‡¶è‡¶¨‡¶Ç ‡¶§‡¶æ‡¶∞ ‡¶™‡ßú‡¶æ‡¶∂‡ßã‡¶®‡¶æ‡¶∞ ‡¶∏‡¶¨ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá ‡¶™‡¶æ‡¶®‡•§</p>
                                    <button
                                        onclick="document.getElementById('add-child-modal').classList.remove('hidden')"
                                        class="btn-primary !px-12 !h-16 !text-lg !rounded-3xl shadow-2xl">‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®
                                        ‡¶è‡¶ñ‡¶®‡¶á</button>
                                </div>
                                <% } %>
        </main>
    </div>

    <!-- Modals -->
    <div id="add-child-modal"
        class="hidden fixed inset-0 bg-slate-950/40 backdrop-blur-md z-[5000] flex items-center justify-center p-6">
        <div class="max-w-md w-full glass-card p-12 relative animate-pop">
            <button onclick="document.getElementById('add-child-modal').classList.add('hidden')"
                class="absolute top-8 right-8 text-slate-400 hover:text-red-500">
                <span class="material-symbols-outlined">close</span>
            </button>
            <div class="text-center mb-10">
                <h3 class="text-3xl font-black mb-2">‡¶∏‡¶®‡ßç‡¶§‡¶æ‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
                <p class="text-slate-500 font-bold text-sm">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶®‡ßç‡¶§‡¶æ‡¶®‡ßá‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶¨‡¶æ ‡¶´‡ßã‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶¶‡¶ø‡¶®</p>
            </div>
            <form action="/parent/add-child" method="POST" class="space-y-6">
                <div class="group">
                    <label
                        class="block text-[10px] font-black text-slate-400 uppercase tracking-[0.3em] mb-3 ml-2">‡¶Ü‡¶á‡¶°‡ßá‡¶®‡ßç‡¶ü‡¶ø‡¶´‡¶æ‡ßü‡¶æ‡¶∞
                        (‡¶á‡¶Æ‡ßá‡¶á‡¶≤/‡¶´‡ßã‡¶®)</label>
                    <input type="text" name="childIdentifier" placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: 017xxxxxxxx"
                        class="w-full h-15 rounded-2xl bg-white dark:bg-slate-900 border border-slate-100 dark:border-slate-800 px-6 font-black focus:ring-4 focus:ring-primary/10 focus:border-primary transition-all shadow-inner"
                        required>
                </div>
                <button type="submit"
                    class="btn-primary w-full h-16 !rounded-3xl !text-lg font-black shadow-2xl shadow-primary/30">‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡ßç‡¶ü
                    ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®</button>
            </form>
        </div>
    </div>

    <script>
        function switchChild(idx) {
            document.querySelectorAll('.child-view').forEach(el => el.classList.add('hidden'));
            document.getElementById('child-view-' + idx).classList.remove('hidden');

            document.querySelectorAll('.child-toggle').forEach(el => {
                el.classList.remove('child-tab-active');
                el.classList.add('bg-white', 'dark:bg-slate-900', 'text-slate-400', 'border', 'border-slate-100', 'dark:border-slate-800');
            });

            const activeBtn = document.getElementById('btn-child-' + idx);
            activeBtn.classList.add('child-tab-active');
            activeBtn.classList.remove('bg-white', 'dark:bg-slate-900', 'text-slate-400', 'border', 'border-slate-100', 'dark:border-slate-800');
        }

        <% if (confirmedChildren) { %>
            <% confirmedChildren.forEach((child, cIdx) => { %>
                const ctx<%= cIdx %> = document.getElementById('chart-<%= cIdx %>').getContext('2d');
            new Chart(ctx <%= cIdx %>, {
                type: 'line',
                data: {
                    labels: ['‡¶∂‡¶®‡¶ø', '‡¶∞‡¶¨‡¶ø', '‡¶∏‡ßã‡¶Æ', '‡¶Æ‡¶ô‡ßç‡¶ó‡¶≤', '‡¶¨‡ßÅ‡¶ß', '‡¶¨‡ßÉ‡¶π‡¶É', '‡¶∂‡ßÅ‡¶ï‡ßç‡¶∞'],
                    datasets: [{
                        data: [1.5, 3.2, 2.8, 4.5, 3.0, 5.2, 4.0],
                        borderColor: '#137fec',
                        backgroundColor: 'rgba(19, 127, 236, 0.05)',
                        fill: true,
                        tension: 0.4,
                        borderWidth: 5,
                        pointRadius: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { display: false, beginAtZero: true },
                        x: { display: true, grid: { display: false }, ticks: { font: { weight: 'bold', size: 10 }, color: '#94a3b8' } }
                    }
                }
            });
            <% }) %>
        <% } %>

            document.addEventListener('DOMContentLoaded', () => {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => entry.isIntersecting && entry.target.classList.add('active'));
                }, { threshold: 0.1 });
                document.querySelectorAll('.reveal').forEach(el => observer.observe(el));

                // Three-dot menu toggle
                const menuBtn = document.getElementById('menu-btn');
                const dropdown = document.getElementById('dropdown-menu');

                if (menuBtn && dropdown) {
                    menuBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        dropdown.classList.toggle('hidden');
                    });

                    document.addEventListener('click', () => {
                        dropdown.classList.add('hidden');
                    });
                }
            });

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('-translate-x-full');
        }
    </script>
</body>

</html>