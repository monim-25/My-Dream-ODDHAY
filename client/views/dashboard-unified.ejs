<!DOCTYPE html>
<html class="light" lang="bn">

<head>
    <%- include('partials/head') %>
        <title>‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶° | ODDHAY</title>
        <style>
            .glass-card {
                background: rgba(255, 255, 255, 0.8);
                backdrop-filter: blur(12px);
                border: 1px solid rgba(255, 255, 255, 0.3);
            }

            .dark .glass-card {
                background: rgba(15, 23, 42, 0.8);
                border: 1px solid rgba(255, 255, 255, 0.05);
            }

            /* Fix for mobile scroll */
            body {
                overflow-x: hidden;
            }

            .pb-safe {
                padding-bottom: env(safe-area-inset-bottom, 20px);
            }
        </style>
</head>

<body class="bg-slate-50 dark:bg-[#0f172a] text-slate-900 dark:text-slate-100 min-h-screen">
    <div class="flex flex-col min-h-screen">

        <!-- Mobile Sidebar Overlay -->
        <div id="sidebarOverlay" class="fixed inset-0 bg-black/50 z-[3999] hidden lg:hidden" onclick="toggleSidebar()">
        </div>

        <!-- Mobile Sidebar (Settings Menu) -->
        <aside id="sidebar"
            class="fixed inset-y-0 left-0 w-72 bg-white dark:bg-slate-900 border-r border-slate-200 dark:border-slate-800 p-6 flex flex-col z-[4000] -translate-x-full transition-transform duration-300 lg:hidden">
            <div class="flex items-center justify-between mb-8">
                <h3 class="text-lg font-black flex items-center gap-2">
                    <span class="material-symbols-outlined text-primary">settings</span> Settings
                </h3>
                <button onclick="toggleSidebar()"
                    class="text-slate-400 p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-xl">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>

            <nav class="space-y-2 flex-1">
                <!-- Dark/Light Mode -->
                <div class="flex items-center justify-between px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800">
                    <div class="flex items-center gap-3">
                        <span class="material-symbols-outlined text-slate-500">dark_mode</span>
                        <span class="font-bold text-sm">‡¶°‡¶æ‡¶∞‡ßç‡¶ï ‡¶Æ‡ßã‡¶°</span>
                    </div>
                    <button onclick="document.documentElement.classList.toggle('dark')"
                        class="size-10 rounded-lg bg-slate-200 dark:bg-slate-700 flex items-center justify-center">
                        <span class="material-symbols-outlined dark:hidden text-sm">toggle_off</span>
                        <span
                            class="material-symbols-outlined hidden dark:block text-amber-400 text-sm">toggle_on</span>
                    </button>
                </div>

                <!-- Language -->
                <div
                    class="flex items-center justify-between px-4 py-3 rounded-xl hover:bg-slate-50 dark:hover:bg-slate-800 cursor-pointer">
                    <div class="flex items-center gap-3">
                        <span class="material-symbols-outlined text-slate-500">translate</span>
                        <span class="font-bold text-sm">‡¶≠‡¶æ‡¶∑‡¶æ</span>
                    </div>
                    <span class="text-xs font-bold text-primary">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</span>
                </div>

                <!-- Routine -->
                <a href="/routine"
                    class="flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-slate-50 dark:hover:bg-slate-800">
                    <span class="material-symbols-outlined text-slate-500">calendar_month</span>
                    <span class="font-bold text-sm">‡¶∞‡ßÅ‡¶ü‡¶ø‡¶®</span>
                </a>

                <!-- Help -->
                <a href="/help"
                    class="flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-slate-50 dark:hover:bg-slate-800">
                    <span class="material-symbols-outlined text-slate-500">help</span>
                    <span class="font-bold text-sm">‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø</span>
                </a>

                <!-- About -->
                <a href="/about"
                    class="flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-slate-50 dark:hover:bg-slate-800">
                    <span class="material-symbols-outlined text-slate-500">info</span>
                    <span class="font-bold text-sm">‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï‡ßá</span>
                </a>
            </nav>

            <div class="pt-4 border-t border-slate-100 dark:border-slate-800">
                <a href="/logout"
                    class="flex items-center gap-3 px-4 py-3 rounded-xl text-red-500 hover:bg-red-50 dark:hover:bg-red-500/10 font-black">
                    <span class="material-symbols-outlined">logout</span> ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü
                </a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 p-4 md:p-8 max-w-6xl mx-auto w-full pb-28">
            <!-- Header -->
            <header class="flex justify-between items-center mb-8">
                <div class="flex items-center gap-3">
                    <button onclick="toggleSidebar()"
                        class="lg:hidden size-10 flex items-center justify-center rounded-xl bg-white dark:bg-slate-800 border border-slate-100 dark:border-slate-800 text-slate-500 shadow-sm">
                        <span class="material-symbols-outlined">menu</span>
                    </button>
                    <div class="flex items-center gap-3">
                        <div
                            class="size-12 rounded-2xl bg-primary/10 border border-primary/20 flex items-center justify-center shrink-0 overflow-hidden">
                            <% if(user.profilePicture) { %>
                                <img src="<%= user.profilePicture %>" class="w-full h-full object-cover">
                                <% } else { %>
                                    <span class="material-symbols-outlined text-primary text-2xl">account_circle</span>
                                    <% } %>
                        </div>
                        <div>
                            <h2 class="text-lg md:text-2xl font-black leading-none">
                                Welcome, <%= user.name.split(' ')[0] %>! üéâ
                            </h2>
                            <p class="text-slate-500 font-bold text-xs hidden md:block"><%= user.classLevel %></p>
                        </div>
                    </div>
                </div>
                <div class="flex items-center gap-2">
                    <!-- Notifications Only -->
                    <div class="relative" id="notificationWrapper">
                        <button id="notificationBtn"
                            class="size-10 rounded-xl bg-white dark:bg-slate-800 border border-slate-100 dark:border-slate-700 text-slate-500 flex items-center justify-center transition-all active:scale-95">
                            <span class="material-symbols-outlined text-xl">notifications</span>
                            <% if(notifications && notifications.filter(n=> !n.isRead).length > 0) { %>
                                <span class="absolute top-1.5 right-1.5 size-2 bg-rose-500 rounded-full"></span>
                            <% } %>
                        </button>

                        <!-- Notifications Dropdown -->
                        <div id="notificationDropdown"
                            class="absolute right-0 mt-2 w-72 bg-white dark:bg-slate-900 rounded-2xl shadow-2xl border border-slate-100 dark:border-slate-800 p-4 hidden z-50">
                            <h5 class="text-sm font-black mb-3">‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶®</h5>
                            <div class="space-y-2 max-h-48 overflow-y-auto">
                                <% if(notifications && notifications.length > 0) { %>
                                    <% notifications.forEach(notif => { %>
                                        <div class="flex gap-2 p-2 rounded-xl hover:bg-slate-50 dark:hover:bg-slate-800">
                                            <div class="size-7 rounded-lg bg-blue-500/10 text-blue-500 flex items-center justify-center shrink-0">
                                                <span class="material-symbols-outlined text-sm">info</span>
                                            </div>
                                            <div>
                                                <p class="text-[10px] font-black"><%= notif.title %></p>
                                                <p class="text-[9px] text-slate-400"><%= notif.message %></p>
                                            </div>
                                        </div>
                                    <% }) %>
                                <% } else { %>
                                    <p class="text-[10px] text-slate-400 text-center py-4">‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡ßã‡¶®‡ßã ‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶®‡ßá‡¶á</p>
                                <% } %>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Parent Request Alert -->
            <% if(parentRequests && parentRequests.length > 0) { %>
                <div class="mb-6 p-4 bg-gradient-to-r from-emerald-500 to-teal-600 rounded-2xl text-white flex flex-col md:flex-row items-center justify-between gap-4 shadow-lg">
                    <div class="flex items-center gap-3 text-center md:text-left">
                        <div class="size-10 rounded-full bg-white/20 flex items-center justify-center">
                            <span class="material-symbols-outlined">family_restroom</span>
                        </div>
                        <div>
                            <h4 class="font-black text-sm">‡¶Ö‡¶≠‡¶ø‡¶≠‡¶æ‡¶¨‡¶ï ‡¶∞‡¶ø‡¶ï‡ßã‡¶Ø‡¶º‡ßá‡¶∏‡ßç‡¶ü!</h4>
                            <p class="text-white/80 text-xs font-bold"><strong><%= parentRequests[0].name %></strong> ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞ ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®‡•§</p>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <form action="/student/reject-parent/<%= parentRequests[0]._id %>" method="POST">
                            <button type="submit" class="px-4 py-2 bg-white/10 text-white rounded-xl font-black text-xs">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤</button>
                        </form>
                        <form action="/student/approve-parent/<%= parentRequests[0]._id %>" method="POST">
                            <button type="submit" class="px-4 py-2 bg-white text-emerald-600 rounded-xl font-black text-xs">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶∞‡ßÅ‡¶≠</button>
                        </form>
                    </div>
                </div>
            <% } %>

            <!-- Main Dashboard Content -->
            <div class="space-y-6">
                
                <!-- Quick Access Section (Full Width) -->
                <div class="bg-white dark:bg-slate-900 p-5 md:p-6 rounded-2xl border border-slate-100 dark:border-slate-800 shadow-sm">
                    <h4 class="text-xs font-black text-slate-400 uppercase tracking-widest mb-4 flex items-center gap-2">
                        <span class="material-symbols-outlined text-primary text-sm">bolt</span> Quick Access
                    </h4>
                    <div class="grid grid-cols-4 md:grid-cols-7 gap-2 md:gap-3">
                        <a href="/courses" class="flex flex-col items-center gap-1.5 p-2 md:p-4 rounded-2xl hover:bg-slate-50 dark:hover:bg-slate-800 transition-all group">
                            <div class="size-12 md:size-14 rounded-2xl bg-blue-500/10 text-blue-500 flex items-center justify-center group-hover:scale-110 transition-transform">
                                <span class="material-symbols-outlined text-xl md:text-2xl">school</span>
                            </div>
                            <p class="text-[9px] md:text-[10px] font-black text-slate-500 group-hover:text-primary">Class</p>
                        </a>
                        <a href="/notes" class="flex flex-col items-center gap-1.5 p-2 md:p-4 rounded-2xl hover:bg-slate-50 dark:hover:bg-slate-800 transition-all group">
                            <div class="size-12 md:size-14 rounded-2xl bg-amber-500/10 text-amber-500 flex items-center justify-center group-hover:scale-110 transition-transform">
                                <span class="material-symbols-outlined text-xl md:text-2xl">description</span>
                            </div>
                            <p class="text-[9px] md:text-[10px] font-black text-slate-500 group-hover:text-primary">Notes</p>
                        </a>
                        <a href="/exams" class="flex flex-col items-center gap-1.5 p-2 md:p-4 rounded-2xl hover:bg-slate-50 dark:hover:bg-slate-800 transition-all group">
                            <div class="size-12 md:size-14 rounded-2xl bg-rose-500/10 text-rose-500 flex items-center justify-center group-hover:scale-110 transition-transform">
                                <span class="material-symbols-outlined text-xl md:text-2xl">edit_note</span>
                            </div>
                            <p class="text-[9px] md:text-[10px] font-black text-slate-500 group-hover:text-primary">Exam</p>
                        </a>
                        <a href="/routine" class="flex flex-col items-center gap-1.5 p-2 md:p-4 rounded-2xl hover:bg-slate-50 dark:hover:bg-slate-800 transition-all group">
                            <div class="size-12 md:size-14 rounded-2xl bg-teal-500/10 text-teal-500 flex items-center justify-center group-hover:scale-110 transition-transform">
                                <span class="material-symbols-outlined text-xl md:text-2xl">calendar_month</span>
                            </div>
                            <p class="text-[9px] md:text-[10px] font-black text-slate-500 group-hover:text-primary">Routine</p>
                        </a>
                        <a href="/ai-assistant" class="flex flex-col items-center gap-1.5 p-2 md:p-4 rounded-2xl hover:bg-slate-50 dark:hover:bg-slate-800 transition-all group">
                            <div class="size-12 md:size-14 rounded-2xl bg-indigo-500/10 text-indigo-500 flex items-center justify-center group-hover:scale-110 transition-transform">
                                <span class="material-symbols-outlined text-xl md:text-2xl">smart_toy</span>
                            </div>
                            <p class="text-[9px] md:text-[10px] font-black text-slate-500 group-hover:text-primary">AI</p>
                        </a>
                        <a href="/question-bank" class="flex flex-col items-center gap-1.5 p-2 md:p-4 rounded-2xl hover:bg-slate-50 dark:hover:bg-slate-800 transition-all group">
                            <div class="size-12 md:size-14 rounded-2xl bg-emerald-500/10 text-emerald-500 flex items-center justify-center group-hover:scale-110 transition-transform">
                                <span class="material-symbols-outlined text-xl md:text-2xl">quiz</span>
                            </div>
                            <p class="text-[9px] md:text-[10px] font-black text-slate-500 group-hover:text-primary">Q-Bank</p>
                        </a>
                        <a href="/qa-forum" class="flex flex-col items-center gap-1.5 p-2 md:p-4 rounded-2xl hover:bg-slate-50 dark:hover:bg-slate-800 transition-all group">
                            <div class="size-12 md:size-14 rounded-2xl bg-purple-500/10 text-purple-500 flex items-center justify-center group-hover:scale-110 transition-transform">
                                <span class="material-symbols-outlined text-xl md:text-2xl">forum</span>
                            </div>
                            <p class="text-[9px] md:text-[10px] font-black text-slate-500 group-hover:text-primary">Q&A</p>
                        </a>
                    </div>
                </div>

                <!-- Upcoming Tasks & My Routine Tasks -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <!-- Upcoming Tasks -->
                    <div class="bg-white dark:bg-slate-900 p-5 rounded-2xl border border-slate-100 dark:border-slate-800 shadow-sm">
                        <h4 class="text-xs font-black text-slate-400 uppercase tracking-widest mb-4 flex items-center gap-2">
                            <span class="material-symbols-outlined text-rose-500 text-sm">schedule</span> ‡¶Ü‡¶∏‡¶®‡ßç‡¶® ‡¶ï‡¶æ‡¶ú
                        </h4>
                        <div class="space-y-2">
                            <div class="flex items-center gap-3 p-2.5 bg-rose-50 dark:bg-rose-500/10 rounded-xl">
                                <div class="size-7 rounded-lg bg-rose-500 text-white flex items-center justify-center shrink-0">
                                    <span class="material-symbols-outlined text-sm">edit_note</span>
                                </div>
                                <div class="flex-1">
                                    <p class="text-[11px] font-black">‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ</p>
                                    <p class="text-[9px] text-slate-500">‡¶ï‡ßã‡¶®‡ßã ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶ø‡¶§ ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶®‡ßá‡¶á</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-3 p-2.5 bg-blue-50 dark:bg-blue-500/10 rounded-xl">
                                <div class="size-7 rounded-lg bg-blue-500 text-white flex items-center justify-center shrink-0">
                                    <span class="material-symbols-outlined text-sm">school</span>
                                </div>
                                <div class="flex-1">
                                    <p class="text-[11px] font-black">‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏</p>
                                    <p class="text-[9px] text-slate-500">‡¶∞‡ßÅ‡¶ü‡¶ø‡¶® ‡¶•‡ßá‡¶ï‡ßá ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- My Routine Tasks -->
                    <div class="bg-white dark:bg-slate-900 p-5 rounded-2xl border border-slate-100 dark:border-slate-800 shadow-sm">
                        <div class="flex items-center justify-between mb-4">
                            <h4 class="text-xs font-black text-slate-400 uppercase tracking-widest flex items-center gap-2">
                                <span class="material-symbols-outlined text-teal-500 text-sm">task_alt</span> ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï
                            </h4>
                            <a href="/routine" class="text-[9px] text-primary font-bold">+ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</a>
                        </div>
                        <div class="space-y-2">
                            <% if(routineTasks && routineTasks.length > 0) { %>
                                <% routineTasks.slice(0, 3).forEach(task => { %>
                                    <div class="flex items-center gap-3 p-2.5 bg-teal-50 dark:bg-teal-500/10 rounded-xl">
                                        <div class="size-7 rounded-lg bg-teal-500 text-white flex items-center justify-center shrink-0">
                                            <span class="material-symbols-outlined text-sm">check_circle</span>
                                        </div>
                                        <div class="flex-1">
                                            <p class="text-[9px] text-slate-500"><%= task.time || ' ‡¶∏‡¶Æ‡ßü ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ
                                    ‡¶π‡ßü‡¶®‡¶ø' %>
                                    </p>
                        </div>
                    </div>
                    <% }) %>
                        <% } else { %>
                            <div class="text-center py-4">
                                <span class="material-symbols-outlined text-2xl text-slate-300">event_busy</span>
                                <p class="text-[10px] text-slate-400 mt-1">‡¶ï‡ßã‡¶®‡ßã ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶®‡ßá‡¶á</p>
                                <a href="/routine" class="text-[10px] text-primary font-bold">‡¶∞‡ßÅ‡¶ü‡¶ø‡¶® ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®</a>
                            </div>
                            <% } %>
                </div>
    </div>

    <!-- Continue Learning -->
    <div class="bg-white dark:bg-slate-900 p-5 rounded-2xl border border-slate-100 dark:border-slate-800 shadow-sm">
        <h4 class="text-xs font-black text-slate-400 uppercase tracking-widest mb-4 flex items-center gap-2">
            <span class="material-symbols-outlined text-primary text-sm">play_circle</span> ‡¶∂‡ßá‡¶ñ‡¶æ ‡¶ö‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ø‡¶æ‡¶®
        </h4>
        <% if(user.lastWatchedLesson && user.lastWatchedLesson.course) { %>
            <div class="flex items-center gap-4">
                <div class="size-16 rounded-xl bg-slate-100 dark:bg-slate-800 overflow-hidden shrink-0">
                    <img src="<%= user.lastWatchedLesson.course.thumbnail || '/images/course-default.jpg' %>"
                        class="w-full h-full object-cover">
                </div>
                <div class="flex-1">
                    <p class="text-xs font-black mb-1 line-clamp-1">
                        <%= user.lastWatchedLesson.lessonTitle %>
                    </p>
                    <p class="text-[10px] text-slate-500 mb-2">
                        <%= user.lastWatchedLesson.course.title %>
                    </p>
                    <a href="/course-details/<%= user.lastWatchedLesson.course._id %>"
                        class="inline-flex items-center gap-1 px-3 py-1.5 bg-primary text-white rounded-lg text-[10px] font-black">
                        ‡¶ö‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ø‡¶æ‡¶® <span class="material-symbols-outlined text-xs">arrow_forward</span>
                    </a>
                </div>
            </div>
            <% } else { %>
                <div class="text-center py-6">
                    <span class="material-symbols-outlined text-4xl text-slate-300 mb-2">play_circle</span>
                    <p class="text-xs text-slate-400">‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø</p>
                </div>
                <% } %>
    </div>
    </div>

    <!-- My Progress Stats -->
    <div class="bg-gradient-to-r from-primary to-indigo-600 p-5 rounded-2xl text-white shadow-lg">
        <h4 class="text-xs font-black uppercase tracking-widest mb-4 flex items-center gap-2 text-white/80">
            <span class="material-symbols-outlined text-sm">trending_up</span> ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶Ö‡¶ó‡ßç‡¶∞‡¶ó‡¶§‡¶ø
        </h4>
        <div class="grid grid-cols-3 gap-4">
            <div class="text-center">
                <p class="text-2xl md:text-3xl font-black">
                    <%= user.completedLessons ? user.completedLessons.length : 0 %>
                </p>
                <p class="text-[10px] text-white/70 font-bold">‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶¶‡ßá‡¶ñ‡¶æ</p>
            </div>
            <div class="text-center">
                <p class="text-2xl md:text-3xl font-black">
                    <%= user.quizResults ? user.quizResults.length : 0 %>
                </p>
                <p class="text-[10px] text-white/70 font-bold">‡¶ï‡ßÅ‡¶á‡¶ú ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®</p>
            </div>
            <div class="text-center">
                <p class="text-2xl md:text-3xl font-black">
                    <%= user.enrolledCourses ? user.enrolledCourses.length : 0 %>
                </p>
                <p class="text-[10px] text-white/70 font-bold">‡¶ï‡ßã‡¶∞‡ßç‡¶∏ ‡¶è‡¶®‡¶∞‡ßã‡¶≤</p>
            </div>
        </div>
    </div>

    <!-- Top Students (Same Class) -->
    <div class="bg-white dark:bg-slate-900 p-5 rounded-2xl border border-slate-100 dark:border-slate-800 shadow-sm">
        <h4 class="text-sm font-black mb-4 flex items-center gap-2">
            <span class="material-symbols-outlined text-amber-500">emoji_events</span> ‡¶ü‡¶™ ‡¶∏‡ßç‡¶ü‡ßÅ‡¶°‡ßá‡¶®‡ßç‡¶ü (<%= user.classLevel
                %>)
        </h4>
        <div class="flex flex-wrap gap-3">
            <% leaderboard.filter(s=> s.classLevel === user.classLevel).slice(0, 5).forEach((student, idx) => { %>
                <div
                    class="flex items-center gap-2 px-3 py-2 rounded-xl bg-slate-50 dark:bg-slate-800 <%= idx === 0 ? 'ring-2 ring-amber-400' : '' %>">
                    <span class="text-sm">
                        <%= idx===0 ? 'ü•á' : (idx===1 ? 'ü•à' : (idx===2 ? 'ü•â' : (idx+1) + '.' )) %>
                    </span>
                    <span class="text-xs font-black">
                        <%= student.name.split(' ')[0] %></span>
                                <span class="text-[10px] text-primary font-bold"><%= student.totalScore %></span>
                            </div>
                        <% }) %>
                    </div>
                </div>

                <!-- Available Courses (Full Width) -->
                <div class="bg-white dark:bg-slate-900 p-5 rounded-2xl border border-slate-100 dark:border-slate-800 shadow-sm">
                    <div class="flex items-center justify-between mb-4">
                        <h4 class="text-sm font-black">‡¶â‡¶™‡¶≤‡¶¨‡ßç‡¶ß ‡¶ï‡ßã‡¶∞‡ßç‡¶∏‡¶∏‡¶Æ‡ßÇ‡¶π</h4>
                        <a href="/courses" class="text-[10px] font-black text-primary uppercase">‡¶∏‡¶¨‡¶ó‡ßÅ‡¶≤‡ßã ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</a>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <% if(recommendations && recommendations.length > 0) { %>
                            <% recommendations.slice(0, 6).forEach(course => { %>
                                <a href="/course-details/<%= course._id %>" class="flex gap-3 p-3 rounded-xl border border-slate-100 dark:border-slate-800 hover:border-primary transition-all group">
                                    <div class="size-14 rounded-xl bg-slate-100 dark:bg-slate-800 overflow-hidden shrink-0">
                                        <img src="<%= course.thumbnail || ' /images/course-default.jpg' %>"
                            class="w-full h-full object-cover">
                </div>
                <div class="flex-1 min-w-0">
                    <h5 class="text-xs font-black truncate group-hover:text-primary">
                        <%= course.title %>
                    </h5>
                    <p class="text-[10px] text-slate-500">
                        <%= course.subject %>
                    </p>
                    <span
                        class="inline-block mt-1 px-2 py-0.5 bg-primary/10 text-primary rounded text-[9px] font-bold">‡¶è‡¶®‡¶∞‡ßã‡¶≤
                        ‡¶ï‡¶∞‡ßÅ‡¶®</span>
                </div>
                </a>
                <% }) %>
                    <% } else { %>
                        <div class="col-span-full py-8 text-center text-slate-400">
                            <p class="text-sm">‡¶è‡¶á ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡ßã‡¶∞‡ßç‡¶∏ ‡¶®‡ßá‡¶á</p>
                        </div>
                        <% } %>
        </div>
    </div>

    </div>
    </main>
    </div>

    <!-- Mobile Bottom Nav (Fixed) -->
    <nav
        class="fixed bottom-0 left-0 right-0 z-[100] bg-white dark:bg-slate-900 border-t border-slate-100 dark:border-slate-800 lg:hidden pb-safe">
        <div class="flex items-center justify-around h-16">
            <a href="/dashboard" class="flex flex-col items-center gap-0.5 text-primary">
                <span class="material-symbols-outlined text-xl">home</span>
                <span class="text-[9px] font-black">‡¶π‡ßã‡¶Æ</span>
            </a>
            <a href="/messages" class="flex flex-col items-center gap-0.5 text-slate-400">
                <span class="material-symbols-outlined text-xl">mail</span>
                <span class="text-[9px] font-black">‡¶Æ‡ßá‡¶∏‡ßá‡¶ú</span>
            </a>
            <a href="/downloads" class="flex flex-col items-center gap-0.5 text-slate-400">
                <span class="material-symbols-outlined text-xl">download</span>
                <span class="text-[9px] font-black">‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°</span>
            </a>
            <a href="/profile" class="flex flex-col items-center gap-0.5 text-slate-400">
                <span class="material-symbols-outlined text-xl">person</span>
                <span class="text-[9px] font-black">‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤</span>
            </a>
        </div>
    </nav>

    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            sidebar.classList.toggle('-translate-x-full');
            overlay.classList.toggle('hidden');
        }

        // Notification dropdown toggle
        const notificationBtn = document.getElementById('notificationBtn');
        const notificationDropdown = document.getElementById('notificationDropdown');
        const notificationWrapper = document.getElementById('notificationWrapper');

        if (notificationBtn && notificationDropdown) {
            notificationBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                notificationDropdown.classList.toggle('hidden');
            });

            document.addEventListener('click', (e) => {
                if (!notificationWrapper.contains(e.target)) {
                    notificationDropdown.classList.add('hidden');
                }
            });
        }
    </script>
</body>

</html>