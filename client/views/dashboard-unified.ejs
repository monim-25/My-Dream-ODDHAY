<!DOCTYPE html>
<html lang="bn">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶Ö‡¶ß‡ßç‡¶Ø‡¶æ‡ßü | ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°</title>
    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Hind+Siliguri:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <!-- Icons -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Outfit', 'Hind Siliguri', 'sans-serif'],
                    },
                    colors: {
                        primary: '#1e293b',
                        accent: '#3b82f6',
                        background: {
                            light: '#f8fafc',
                            dark: '#020617'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Hind Siliguri', 'Outfit', sans-serif;
        }

        .glass-effect {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
        }

        .dark .glass-effect {
            background: rgba(15, 23, 42, 0.85);
        }

        .pb-safe {
            padding-bottom: env(safe-area-inset-bottom);
        }

        .sidebar-active {
            background: #eff6ff;
            color: #2563eb;
            font-weight: 700;
        }

        .dark .sidebar-active {
            background: rgba(30, 41, 59, 0.5);
            color: #60a5fa;
        }
    </style>
</head>

<body
    class="bg-background-light text-slate-900 dark:bg-background-dark dark:text-slate-100 min-h-screen transition-colors duration-300">

    <!-- Top Navbar -->
    <nav class="fixed top-0 left-0 right-0 z-50 glass-effect border-b border-slate-200 dark:border-slate-800 h-16">
        <div class="max-w-[1440px] mx-auto px-4 lg:px-6 h-full flex items-center justify-between">
            <div class="flex items-center gap-4">
                <button onclick="toggleSidebar()"
                    class="lg:hidden p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-xl transition-colors">
                    <span class="material-symbols-outlined">menu</span>
                </button>
                <a href="/" class="flex items-center gap-2.5">
                    <div
                        class="size-9 bg-primary dark:bg-accent rounded-xl flex items-center justify-center text-white shadow-lg">
                        <span class="material-symbols-outlined text-2xl font-bold">menu_book</span>
                    </div>
                    <span class="text-2xl font-black tracking-tighter text-slate-800 dark:text-white">‡¶Ö‡¶ß‡ßç‡¶Ø‡¶æ‡ßü</span>
                </a>
            </div>

            <div class="flex items-center gap-3">
                <!-- Notifications -->
                <button
                    class="p-2.5 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors relative">
                    <span class="material-symbols-outlined text-[28px]">notifications</span>
                    <% if(notifications && notifications.length> 0) { %>
                        <span
                            class="absolute top-2.5 right-2.5 size-2.5 bg-red-500 rounded-full border-2 border-white dark:border-slate-900"></span>
                        <% } %>
                </button>
                <!-- Profile Link -->
                <a href="/profile"
                    class="size-10 rounded-full overflow-hidden border-2 border-white dark:border-slate-800 shadow-sm hover:ring-2 ring-accent transition-all">
                    <img src="<%= user.profileImage || `https://ui-avatars.com/api/?name=${user.name}&background=random` %>"
                        class="w-full h-full object-cover">
                </a>
            </div>
        </div>
    </nav>

    <!-- Sidebar -->
    <aside id="sidebar"
        class="fixed top-16 left-0 bottom-0 w-72 bg-white dark:bg-slate-900 border-r border-slate-200 dark:border-slate-800 z-40 transform -translate-x-full lg:translate-x-0 transition-transform duration-300">
        <div class="h-full flex flex-col p-4">

            <div class="flex items-center justify-between px-3 mb-4">
                <span class="text-xs font-black text-slate-400 uppercase tracking-widest">‡¶Æ‡ßá‡¶á‡¶® ‡¶Æ‡ßá‡¶®‡ßÅ</span>
                <button onclick="toggleSettings()"
                    class="size-8 flex items-center justify-center rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-400">
                    <span class="material-symbols-outlined text-xl">settings_adjust</span>
                </button>
            </div>

            <div class="space-y-1 flex-1">
                <a href="/dashboard" class="flex items-center gap-3.5 px-4 py-3 rounded-2xl sidebar-active">
                    <span class="material-symbols-outlined">dashboard</span> ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°
                </a>
                <a href="/courses"
                    class="flex items-center gap-3.5 px-4 py-3 rounded-2xl text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors">
                    <span class="material-symbols-outlined">school</span> ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶ï‡ßã‡¶∞‡ßç‡¶∏
                </a>
                <a href="/routine"
                    class="flex items-center gap-3.5 px-4 py-3 rounded-2xl text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors">
                    <span class="material-symbols-outlined">calendar_month</span> ‡¶∞‡ßÅ‡¶ü‡¶ø‡¶®
                </a>
                <a href="/messages"
                    class="flex items-center gap-3.5 px-4 py-3 rounded-2xl text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors">
                    <span class="material-symbols-outlined">forum</span> ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú
                </a>
                <a href="/downloads"
                    class="flex items-center gap-3.5 px-4 py-3 rounded-2xl text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors">
                    <span class="material-symbols-outlined">download</span> ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°
                </a>
            </div>

            <div class="mt-8">
                <span
                    class="text-xs font-black text-slate-400 uppercase tracking-widest px-3 block mb-4">‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø</span>
                <div class="space-y-1">
                    <a href="/analytics"
                        class="flex items-center gap-3.5 px-4 py-3 rounded-2xl text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors">
                        <span class="material-symbols-outlined">analytics</span> ‡¶è‡¶®‡¶æ‡¶≤‡¶ø‡¶ü‡¶ø‡¶ï‡ßç‡¶∏
                    </a>
                    <a href="/leaderboard"
                        class="flex items-center gap-3.5 px-4 py-3 rounded-2xl text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors">
                        <span class="material-symbols-outlined">leaderboard</span> ‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°
                    </a>
                    <a href="/contact"
                        class="flex items-center gap-3.5 px-4 py-3 rounded-2xl text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors">
                        <span class="material-symbols-outlined">headset_mic</span> ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó
                    </a>
                </div>
            </div>

            <div class="mt-auto pt-6 border-t border-slate-100 dark:border-slate-800">
                <a href="/logout"
                    class="flex items-center gap-3.5 px-4 py-3 rounded-2xl text-red-500 hover:bg-red-50 dark:hover:bg-red-900/10 transition-colors">
                    <span class="material-symbols-outlined">logout</span> ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü
                </a>
            </div>
        </div>
    </aside>

    <!-- Settings Modal -->
    <div id="settings-modal" class="fixed inset-0 z-[100] flex items-center justify-center hidden">
        <div class="absolute inset-0 bg-slate-900/50 backdrop-blur-sm" onclick="toggleSettings()"></div>
        <div
            class="bg-white dark:bg-slate-900 w-[320px] rounded-3xl p-6 shadow-2xl relative z-10 border border-slate-200 dark:border-slate-800 anim-fade-in">
            <h2 class="text-xl font-black mb-6 flex items-center gap-2">
                <span class="material-symbols-outlined">settings_adjust</span> ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏
            </h2>
            <div class="space-y-6">
                <!-- Theme -->
                <div>
                    <label class="text-xs font-black text-slate-400 uppercase mb-3 block">‡¶•‡¶ø‡¶Æ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®</label>
                    <div class="grid grid-cols-2 gap-2">
                        <button onclick="setTheme('light')"
                            class="flex items-center justify-center gap-2 p-3 rounded-xl border border-slate-200 dark:border-slate-800 hover:bg-slate-50 dark:hover:bg-slate-800 transition-all font-bold text-sm">
                            <span class="material-symbols-outlined text-lg">light_mode</span> ‡¶≤‡¶æ‡¶á‡¶ü
                        </button>
                        <button onclick="setTheme('dark')"
                            class="flex items-center justify-center gap-2 p-3 rounded-xl border border-slate-200 dark:border-slate-800 hover:bg-slate-50 dark:hover:bg-slate-800 transition-all font-bold text-sm">
                            <span class="material-symbols-outlined text-lg">dark_mode</span> ‡¶°‡¶æ‡¶∞‡ßç‡¶ï
                        </button>
                    </div>
                </div>
                <!-- Language -->
                <div>
                    <label class="text-xs font-black text-slate-400 uppercase mb-3 block">‡¶≠‡¶æ‡¶∑‡¶æ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®</label>
                    <select
                        class="w-full p-3 rounded-xl border border-slate-200 dark:border-slate-800 bg-transparent font-bold text-sm active:ring-accent outline-none">
                        <option value="bn">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</option>
                        <option value="en">English</option>
                    </select>
                </div>
            </div>
            <button onclick="toggleSettings()"
                class="w-full mt-8 p-4 bg-slate-900 dark:bg-accent text-white rounded-2xl font-black shadow-lg">‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£
                ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>
    </div>

    <!-- Main Content -->
    <main class="lg:ml-72 pt-16 min-h-screen px-4 lg:px-6 pb-24">
        <div class="max-w-[1200px] mx-auto pt-6 space-y-6">

            <!-- Welcome Banner -->
            <div
                class="bg-white dark:bg-slate-900 rounded-[2.5rem] p-6 lg:p-8 border border-slate-200 dark:border-slate-800 shadow-sm relative overflow-hidden">
                <div class="flex flex-col md:flex-row items-center gap-8 relative z-10">
                    <div
                        class="size-24 lg:size-32 rounded-[2rem] overflow-hidden ring-4 ring-slate-100 dark:ring-slate-800 shadow-xl shrink-0">
                        <img src="<%= user.profileImage || `https://ui-avatars.com/api/?name=${user.name}&background=random` %>"
                            class="w-full h-full object-cover">
                    </div>
                    <div class="text-center md:text-left">
                        <h1 class="text-3xl lg:text-4xl font-black tracking-tight mb-2">‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ, <%= user.name %>!</h1>
                        <p class="text-slate-500 dark:text-slate-400 font-medium max-w-xl">
                            ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶™‡ßú‡¶æ‡¶∂‡ßã‡¶®‡¶æ ‡¶ö‡¶æ‡¶≤‡¶ø‡ßü‡ßá ‡¶Ø‡¶æ‡¶ì ‡¶è‡¶¨‡¶Ç ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶∂‡¶ø‡¶ñ‡ßã‡•§ ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶¶‡¶ø‡¶®‡¶ü‡¶ø ‡¶π‡ßã‡¶ï ‡¶∏‡¶´‡¶≤‡¶§‡¶æ‡¶∞! üöÄ
                        </p>
                    </div>
                </div>

                <!-- First Visit Alert (Session Flag) -->
                <% if(locals.isFirstLogin) { %>
                    <div id="welcome-overlay"
                        class="absolute inset-0 z-20 flex items-center justify-center bg-slate-900/80 backdrop-blur-md anim-fade-in">
                        <div
                            class="text-center p-8 bg-white dark:bg-slate-900 rounded-[3rem] shadow-2xl max-w-md border border-slate-200 dark:border-slate-800 mx-4">
                            <div
                                class="size-20 bg-accent/10 text-accent rounded-full flex items-center justify-center mx-auto mb-6">
                                <span class="material-symbols-outlined text-4xl">celebration</span>
                            </div>
                            <h2 class="text-2xl font-black mb-3">‡¶Ö‡¶ß‡ßç‡¶Ø‡¶æ‡ßü-‡¶è ‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ!</h2>
                            <p class="text-slate-500 text-sm mb-8 leading-relaxed">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∂‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶Ø‡¶æ‡¶§‡ßç‡¶∞‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∏‡¶¨
                                ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§‡•§ ‡¶Ü‡¶ú‡¶á ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
                            <button onclick="closeWelcome()"
                                class="w-full p-4 bg-accent text-white rounded-2xl font-black shadow-lg hover:ring-4 ring-accent/20 transition-all">‡¶∂‡ßÅ‡¶∞‡ßÅ
                                ‡¶ï‡¶∞‡¶ø!</button>
                        </div>
                    </div>
                    <% } %>
            </div>

            <!-- Dashboard Center Content -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">

                <!-- Left: Leaderboard & Stats -->
                <div class="space-y-6">
                    <div
                        class="bg-white dark:bg-slate-900 p-6 rounded-[2rem] border border-slate-200 dark:border-slate-800 shadow-sm">
                        <h2 class="text-lg font-black mb-6 flex items-center gap-2">
                            <span class="material-symbols-outlined text-amber-500">military_tech</span> ‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°
                        </h2>
                        <div class="space-y-4">
                            <% if(leaderboard && leaderboard.length> 0) { %>
                                <% leaderboard.slice(0, 5).forEach((item, index)=> { %>
                                    <div
                                        class="flex items-center gap-4 p-3 rounded-2xl hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors border border-transparent hover:border-slate-100 dark:hover:border-slate-800">
                                        <div
                                            class="size-10 rounded-xl bg-slate-100 dark:bg-slate-800 flex items-center justify-center font-bold text-slate-500">
                                            #<%= index + 1 %>
                                        </div>
                                        <div class="flex-1">
                                            <p class="font-bold text-sm">
                                                <%= item.name %>
                                            </p>
                                            <p class="text-[10px] text-slate-400 uppercase font-black tracking-widest">
                                                <%= item.classLevel %>
                                            </p>
                                        </div>
                                        <div class="text-right">
                                            <p class="font-black text-accent">
                                                <%= item.totalScore %> pts
                                            </p>
                                        </div>
                                    </div>
                                    <% }) %>
                                        <% } else { %>
                                            <p class="text-center text-slate-400 text-sm py-4">‡¶è‡¶ñ‡¶®‡ßã ‡¶§‡¶•‡ßç‡¶Ø ‡¶®‡ßá‡¶á</p>
                                            <% } %>
                        </div>
                        <a href="/leaderboard"
                            class="block w-full text-center mt-6 text-xs font-black text-slate-400 hover:text-accent uppercase tracking-widest transition-colors">‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£
                            ‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</a>
                    </div>
                </div>

                <!-- Right: Quick Services Grid (3x2/3x3 larger) -->
                <div
                    class="bg-white dark:bg-slate-900 p-6 lg:p-8 rounded-[2rem] border border-slate-200 dark:border-slate-800 shadow-sm">
                    <h2 class="text-lg font-black mb-8 flex items-center justify-between">
                        ‡¶ï‡ßÅ‡¶á‡¶ï ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏
                    </h2>
                    <div class="grid grid-cols-3 gap-4 lg:gap-6">
                        <a href="/courses"
                            class="flex flex-col items-center gap-3 p-4 rounded-3xl hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-slate-100 dark:border-slate-800 hover:border-blue-200 transition-all group">
                            <div
                                class="size-16 rounded-2xl bg-blue-500 text-white flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform">
                                <span class="material-symbols-outlined text-3xl">class</span>
                            </div>
                            <span class="font-bold text-sm">‡¶ï‡ßç‡¶≤‡¶æ‡¶∏</span>
                        </a>
                        <a href="/exams"
                            class="flex flex-col items-center gap-3 p-4 rounded-3xl hover:bg-red-50 dark:hover:bg-red-900/20 border border-slate-100 dark:border-slate-800 hover:border-red-200 transition-all group">
                            <div
                                class="size-16 rounded-2xl bg-red-500 text-white flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform">
                                <span class="material-symbols-outlined text-3xl">edit_document</span>
                            </div>
                            <span class="font-bold text-sm">‡¶è‡¶ï‡ßç‡¶∏‡¶æ‡¶Æ</span>
                        </a>
                        <a href="/notes"
                            class="flex flex-col items-center gap-3 p-4 rounded-3xl hover:bg-amber-50 dark:hover:bg-amber-900/20 border border-slate-100 dark:border-slate-800 hover:border-amber-200 transition-all group">
                            <div
                                class="size-16 rounded-2xl bg-amber-500 text-white flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform">
                                <span class="material-symbols-outlined text-3xl">description</span>
                            </div>
                            <span class="font-bold text-sm">‡¶®‡ßã‡¶ü‡¶∏</span>
                        </a>
                        <a href="/ai-chat"
                            class="flex flex-col items-center gap-3 p-4 rounded-3xl hover:bg-purple-50 dark:hover:bg-purple-900/20 border border-slate-100 dark:border-slate-800 hover:border-purple-200 transition-all group">
                            <div
                                class="size-16 rounded-2xl bg-purple-500 text-white flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform">
                                <span class="material-symbols-outlined text-3xl">magic_button</span>
                            </div>
                            <span class="font-bold text-sm">AI ‡¶ü‡¶ø‡¶â‡¶ü‡¶∞</span>
                        </a>
                        <a href="/qa"
                            class="flex flex-col items-center gap-3 p-4 rounded-3xl hover:bg-emerald-50 dark:hover:bg-emerald-900/20 border border-slate-100 dark:border-slate-800 hover:border-emerald-200 transition-all group">
                            <div
                                class="size-16 rounded-2xl bg-emerald-500 text-white flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform">
                                <span class="material-symbols-outlined text-3xl">chat_bubble</span>
                            </div>
                            <span class="font-bold text-sm">Q&A</span>
                        </a>
                        <a href="/question-bank"
                            class="flex flex-col items-center gap-3 p-4 rounded-3xl hover:bg-indigo-50 dark:hover:bg-indigo-900/20 border border-slate-100 dark:border-slate-800 hover:border-indigo-200 transition-all group">
                            <div
                                class="size-16 rounded-2xl bg-indigo-500 text-white flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform">
                                <span class="material-symbols-outlined text-3xl">library_books</span>
                            </div>
                            <span class="font-bold text-sm">Q ‡¶¨‡ßç‡¶Ø‡¶æ‡¶Ç‡¶ï</span>
                        </a>
                    </div>
                </div>

            </div>

            <!-- Continue Learning & Enrolled Section -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Continue Learning -->
                <div
                    class="bg-white dark:bg-slate-900 p-6 rounded-[2.5rem] border border-slate-200 dark:border-slate-800 shadow-sm">
                    <h2
                        class="text-sm font-black text-slate-400 uppercase tracking-widest mb-6 flex items-center gap-2">
                        <span class="material-symbols-outlined text-accent text-lg">play_circle</span> ‡¶∂‡ßá‡¶ñ‡¶æ ‡¶ö‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ø‡¶æ‡¶®
                    </h2>
                    <% if(user.lastWatchedLesson && user.lastWatchedLesson.course) { %>
                        <div class="flex gap-5">
                            <div
                                class="w-40 aspect-video rounded-2xl bg-slate-100 dark:bg-slate-800 overflow-hidden shrink-0 shadow-md">
                                <img src="<%= user.lastWatchedLesson.course.thumbnail %>"
                                    class="w-full h-full object-cover">
                            </div>
                            <div class="flex-1">
                                <h4 class="font-bold text-slate-800 dark:text-white line-clamp-1">
                                    <%= user.lastWatchedLesson.lessonTitle %>
                                </h4>
                                <p class="text-xs text-slate-500 mt-1 mb-4">
                                    <%= user.lastWatchedLesson.course.title %>
                                </p>
                                <a href="/course-details/<%= user.lastWatchedLesson.course._id %>"
                                    class="px-5 py-2.5 bg-accent text-white rounded-xl text-xs font-black shadow-lg shadow-accent/20">‡¶ö‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡ßá
                                    ‡¶Ø‡¶æ‡¶®</a>
                            </div>
                        </div>
                        <% } else { %>
                            <div
                                class="py-6 text-center border-2 border-dashed border-slate-100 dark:border-slate-800 rounded-2xl">
                                <p class="text-slate-400 text-xs">‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø</p>
                            </div>
                            <% } %>
                </div>

                <!-- Enrolled Box (Moved here beside Continue Learning) -->
                <div
                    class="bg-white dark:bg-slate-900 p-6 rounded-[2.5rem] border border-slate-200 dark:border-slate-800 shadow-sm">
                    <h2
                        class="text-sm font-black text-slate-400 uppercase tracking-widest mb-6 flex items-center gap-2">
                        <span class="material-symbols-outlined text-emerald-500 text-lg">fact_check</span> ‡¶è‡¶®‡¶∞‡ßã‡¶≤ ‡¶ï‡¶∞‡¶æ
                        ‡¶ï‡ßã‡¶∞‡ßç‡¶∏
                    </h2>
                    <div
                        class="flex items-center justify-between p-6 bg-slate-50 dark:bg-slate-800/50 rounded-3xl border border-slate-100 dark:border-slate-800">
                        <div>
                            <p class="text-4xl font-black text-slate-800 dark:text-white">
                                <%= user.enrolledCourses ? user.enrolledCourses.length : 0 %>
                            </p>
                            <p class="text-xs font-bold text-slate-400 mt-1 uppercase tracking-widest">‡¶Æ‡ßã‡¶ü ‡¶ï‡ßã‡¶∞‡ßç‡¶∏</p>
                        </div>
                        <a href="/my-courses"
                            class="size-14 bg-white dark:bg-slate-800 rounded-2xl flex items-center justify-center text-slate-800 dark:text-white shadow-md border border-slate-100 dark:border-slate-700 hover:scale-105 transition-transform">
                            <span class="material-symbols-outlined">chevron_right</span>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Task List with Update Button -->
            <div
                class="bg-white dark:bg-slate-900 p-6 lg:p-8 rounded-[2.5rem] border border-slate-200 dark:border-slate-800 shadow-sm">
                <div class="flex items-center justify-between mb-8">
                    <h2 class="text-lg font-black flex items-center gap-2">
                        <span class="material-symbols-outlined text-blue-500">task_alt</span> ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶∞‡ßÅ‡¶ü‡¶ø‡¶®
                    </h2>
                    <a href="/routine"
                        class="flex items-center gap-2 px-6 py-2.5 bg-slate-900 dark:bg-accent text-white rounded-2xl text-xs font-bold shadow-lg">
                        <span class="material-symbols-outlined text-sm">update</span> ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
                    </a>
                </div>
                <!-- Routine Items -->
                <div class="space-y-3">
                    <% if(routineTasks && routineTasks.length> 0) { %>
                        <% routineTasks.slice(0, 3).forEach(task=> { %>
                            <div
                                class="flex items-center gap-4 p-4 rounded-3xl bg-slate-50 dark:bg-slate-800/30 border border-slate-50 dark:border-slate-800">
                                <div
                                    class="size-10 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 flex items-center justify-center">
                                    <span class="material-symbols-outlined text-xl">event_available</span>
                                </div>
                                <div class="flex-1">
                                    <p class="font-bold text-sm">
                                        <%= task.title %>
                                    </p>
                                    <p class="text-[10px] text-slate-400 font-bold uppercase">
                                        <%= task.time || '‡¶∏‡¶Æ‡ßü ‡¶®‡ßá‡¶á' %>
                                    </p>
                                </div>
                                <input type="checkbox"
                                    class="size-6 rounded-lg border-2 border-slate-200 dark:border-slate-700 accent-accent">
                            </div>
                            <% }) %>
                                <% } else { %>
                                    <div class="py-12 text-center text-slate-400">
                                        <span
                                            class="material-symbols-outlined text-4xl mb-2 opacity-20">event_busy</span>
                                        <p class="text-sm">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡ßã‡¶®‡ßã ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶®‡ßá‡¶á</p>
                                    </div>
                                    <% } %>
                </div>
            </div>

            <!-- Courses (Full Width) -->
            <div
                class="bg-white dark:bg-slate-900 p-6 lg:p-8 rounded-[3rem] border border-slate-200 dark:border-slate-800 shadow-sm">
                <div class="flex items-center justify-between mb-8">
                    <h2 class="text-lg font-black flex items-center gap-2 text-slate-800 dark:text-white">
                        <span class="size-2 bg-accent rounded-full"></span> ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡ßã‡¶∞‡ßç‡¶∏‡¶∏‡¶Æ‡ßÇ‡¶π (Class <%= user.classLevel
                            || '‡¶∏‡¶ï‡¶≤' %>)
                    </h2>
                    <a href="/courses"
                        class="text-xs font-bold text-slate-400 hover:text-accent uppercase tracking-widest">‡¶∏‡¶¨
                        ‡¶ï‡ßã‡¶∞‡ßç‡¶∏</a>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <% if(recommendations && recommendations.length> 0) { %>
                        <% recommendations.forEach(course=> { %>
                            <a href="/course-details/<%= course._id %>"
                                class="group block bg-slate-50 dark:bg-slate-800/50 p-4 rounded-[2rem] border border-slate-50 dark:border-slate-800 hover:border-accent/30 transition-all shadow-sm">
                                <div class="aspect-video rounded-2xl overflow-hidden mb-4 shadow-md bg-slate-200">
                                    <img src="<%= course.thumbnail %>"
                                        class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700">
                                </div>
                                <h4
                                    class="font-black text-slate-800 dark:text-white line-clamp-1 mb-1 group-hover:text-accent transition-colors">
                                    <%= course.title %>
                                </h4>
                                <p class="text-xs text-slate-500 font-bold uppercase tracking-wider mb-4">
                                    <%= course.subject %>
                                </p>
                                <div
                                    class="flex items-center justify-between pt-4 border-t border-slate-200 dark:border-slate-700">
                                    <div class="flex items-center gap-2">
                                        <div class="size-6 rounded-full bg-slate-200"></div>
                                        <span class="text-[10px] font-bold text-slate-400">ODDHAY</span>
                                    </div>
                                    <span
                                        class="px-3 py-1 bg-slate-900 dark:bg-accent text-white rounded-lg text-[10px] font-black">‡¶è‡¶®‡¶∞‡ßã‡¶≤
                                        ‡¶ï‡¶∞‡ßÅ‡¶®</span>
                                </div>
                            </a>
                            <% }) %>
                                <% } else { %>
                                    <p class="col-span-full text-center text-slate-400 py-12">‡¶Ü‡¶™‡¶æ‡¶§‡¶§ ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡ßã‡¶®‡ßã ‡¶ï‡ßã‡¶∞‡ßç‡¶∏ ‡¶®‡ßá‡¶á
                                    </p>
                                    <% } %>
                </div>
            </div>

            <!-- Progress Graph (Bottom Full Width) -->
            <div
                class="bg-white dark:bg-slate-900 p-6 lg:p-10 rounded-[3rem] border border-slate-200 dark:border-slate-800 shadow-sm">
                <h2 class="text-xl font-black mb-8 flex items-center gap-3">
                    <span class="material-symbols-outlined text-accent text-3xl">insights</span> ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶ó‡ßç‡¶∞‡¶ó‡¶§‡¶ø ‡¶ó‡ßç‡¶∞‡¶æ‡¶´
                </h2>
                <div class="h-[350px] w-full relative">
                    <canvas id="progressChart"></canvas>
                </div>
            </div>

        </div>
    </main>

    <!-- Mobile Bottom Nav -->
    <nav
        class="fixed bottom-0 left-0 right-0 h-16 bg-white dark:bg-slate-900 border-t border-slate-100 dark:border-slate-800 flex items-center justify-around lg:hidden z-50 pb-safe">
        <a href="/dashboard" class="flex flex-col items-center justify-center w-full h-full text-accent">
            <span class="material-symbols-outlined text-2xl font-bold">dashboard</span>
        </a>
        <a href="/courses" class="flex flex-col items-center justify-center w-full h-full text-slate-400">
            <span class="material-symbols-outlined text-2xl">school</span>
        </a>
        <div class="relative -top-5">
            <a href="/messages"
                class="size-14 bg-accent text-white rounded-2xl flex items-center justify-center shadow-lg transform rotate-45">
                <span class="material-symbols-outlined text-2xl -rotate-45">forum</span>
            </a>
        </div>
        <a href="/routine" class="flex flex-col items-center justify-center w-full h-full text-slate-400">
            <span class="material-symbols-outlined text-2xl">calendar_today</span>
        </a>
        <a href="/profile" class="flex flex-col items-center justify-center w-full h-full text-slate-400">
            <span class="material-symbols-outlined text-2xl">person</span>
        </a>
    </nav>

    <script>
        // Sidebar Toggle
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            if (sidebar.classList.contains('-translate-x-full')) {
                sidebar.classList.remove('-translate-x-full');
            } else {
                sidebar.classList.add('-translate-x-full');
            }
        }

        // Settings Modal
        function toggleSettings() {
            const modal = document.getElementById('settings-modal');
            modal.classList.toggle('hidden');
        }

        function closeWelcome() {
            document.getElementById('welcome-overlay').style.display = 'none';
        }

        function setTheme(theme) {
            if (theme === 'dark') document.documentElement.classList.add('dark');
            else document.documentElement.classList.remove('dark');
            localStorage.setItem('theme', theme);
        }

        // Chart Init
        document.addEventListener('DOMContentLoaded', () => {
            const ctx = document.getElementById('progressChart').getContext('2d');
            <% 
               const graphData = (user.quizResults || []).map(q => q.score).slice(-7);
            const graphLabels = (user.quizResults || []).map((_, i) => `Test ${i + 1}`).slice(-7);
            %>
            const data = {
                labels: <% - JSON.stringify(graphLabels.length ? graphLabels : ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5']) %>,
                datasets: [{
                    label: 'Score',
                    data: <% - JSON.stringify(graphData.length ? graphData : [10, 25, 15, 45, 30]) %>,
                    borderColor: '#3b82f6',
                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                    borderWidth: 5,
                    tension: 0.4,
                    fill: true,
                    pointRadius: 6,
                    pointBackgroundColor: '#fff',
                    pointBorderWidth: 4,
                }]
            };
            new Chart(ctx, {
                type: 'line',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(0,0,0,0.05)', drawBorder: false },
                            ticks: { display: false }
                        },
                        x: {
                            grid: { display: false, drawBorder: false },
                            ticks: { font: { family: 'Outfit', weight: 'bold' } }
                        }
                    }
                }
            });
        });

        // Auto Dark Mode
        if (localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark')
        }
    </script>
</body>

</html>