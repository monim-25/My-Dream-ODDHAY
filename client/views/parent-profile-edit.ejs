<!DOCTYPE html>
<html class="light" lang="bn">

<head>
    <%- include('partials/head') %>
        <title>এডিট প্রোফাইল | অধ্যায়</title>
</head>

<body class="bg-slate-50 dark:bg-[#0f172a] text-slate-900 dark:text-slate-100 min-h-screen">
    <!-- Header -->
    <header
        class="fixed top-0 left-0 right-0 z-[100] bg-white dark:bg-slate-900 border-b border-slate-100 dark:border-slate-800 px-6 py-4 flex items-center gap-4">
        <button onclick="window.history.back()"
            class="size-11 flex items-center justify-center rounded-xl bg-slate-100 dark:bg-slate-800 text-slate-500 hover:text-primary transition-all">
            <span class="material-symbols-outlined">arrow_back_ios_new</span>
        </button>
        <h1 class="text-xl font-black">এডিট প্রোফাইল</h1>
    </header>

    <main class="pt-28 pb-20 px-6 max-w-2xl mx-auto w-full space-y-8">
        <% if (error) { %>
            <div
                class="p-4 bg-red-50 dark:bg-red-500/10 border border-red-100 dark:border-red-500/20 text-red-500 rounded-2xl font-bold text-sm animate-pop">
                <% if(error==='wrong_old_password' ) { %> বর্তমান পাসওয়ার্ডটি সঠিক নয়। <% } %>
                        <% if(error==='old_password_required' ) { %> পাসওয়ার্ড পরিবর্তন করতে বর্তমান পাসওয়ার্ড অবশ্যই
                            প্রয়োজন। <% } %>
                                <% if(error==='update_failed' ) { %> আপডেট করা সম্ভব হয়নি। আবার চেষ্টা করুন। <% } %>
            </div>
            <% } %>

                <form action="/profile/update" method="POST" class="space-y-8 animate-pop">
                    <!-- Profile Picture -->
                    <div
                        class="bg-white dark:bg-slate-900 p-8 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 flex flex-col items-center">
                        <div class="relative group">
                            <div
                                class="size-24 rounded-[1.8rem] bg-gradient-to-br from-primary to-blue-600 flex items-center justify-center text-white text-3xl font-black shadow-2xl">
                                <%= user.name[0] %>
                            </div>
                            <label for="avatar"
                                class="absolute -bottom-1 -right-1 size-9 bg-white dark:bg-slate-800 rounded-lg shadow-lg border border-slate-100 dark:border-slate-700 flex items-center justify-center cursor-pointer hover:text-primary transition-all">
                                <span class="material-symbols-outlined text-sm">photo_camera</span>
                            </label>
                            <input type="file" id="avatar" class="hidden">
                        </div>
                        <p class="text-sm font-black text-slate-400 mt-4 uppercase">প্রোফাইল ছবি পরিবর্তন করুন</p>
                    </div>

                    <!-- Identity Fields -->
                    <div
                        class="bg-white dark:bg-slate-900 p-8 md:p-10 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 space-y-6">
                        <div class="space-y-2">
                            <label class="text-xs font-black text-slate-400 uppercase ml-2 tracking-wide">আপনার
                                নাম</label>
                            <input type="text" name="name" value="<%= user.name %>"
                                class="w-full h-15 rounded-2xl bg-slate-50 dark:bg-slate-950 border-none px-6 font-black focus:ring-4 focus:ring-primary/10 transition-all shadow-inner"
                                required />
                        </div>

                        <div class="space-y-2">
                            <label class="text-xs font-black text-slate-400 uppercase ml-2 tracking-wide">ইমেইল
                                এড্রেস</label>
                            <input type="email" name="email" value="<%= user.email || '' %>"
                                placeholder="<%= !user.email ? 'আপনার ইমেইল যুক্ত করুন' : '' %>" <%=user.email
                                ? 'readonly disabled' : '' %>
                            class="w-full h-15 rounded-2xl bg-slate-50 dark:bg-slate-950 border-none px-6 font-black
                            focus:ring-4 focus:ring-primary/10 transition-all shadow-inner <%= user.email ? 'opacity-50'
                                : '' %>" />
                                <% if(!user.email) { %>
                                    <p class="text-[9px] font-bold text-amber-500 ml-2">* আপনার ইমেইলটি যুক্ত করা জরুরি।
                                    </p>
                                    <% } %>
                        </div>

                        <div class="space-y-2">
                            <label class="text-xs font-black text-slate-400 uppercase ml-2 tracking-wide">ফোন
                                নম্বর</label>
                            <input type="text" name="phone" value="<%= user.phone || '' %>"
                                placeholder="<%= !user.phone ? 'আপনার ফোন নম্বর যুক্ত করুন' : '' %>" <%=user.phone
                                ? 'readonly disabled' : '' %>
                            class="w-full h-15 rounded-2xl bg-slate-50 dark:bg-slate-950 border-none px-6 font-black
                            focus:ring-4 focus:ring-primary/10 transition-all shadow-inner <%= user.phone ? 'opacity-50'
                                : '' %>" />
                                <% if(!user.phone) { %>
                                    <p class="text-[9px] font-bold text-amber-500 ml-2">* আপনার ফোন নম্বরটি যুক্ত করা
                                        জরুরি।</p>
                                    <% } %>
                        </div>
                    </div>

                    <!-- Secure Password Section -->
                    <div
                        class="bg-white dark:bg-slate-900 p-8 md:p-10 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 space-y-6">
                        <h3 class="text-sm font-black text-slate-400">পাসওয়ার্ড পরিবর্তন করুন</h3>

                        <div class="space-y-2">
                            <label class="text-xs font-black text-slate-400 uppercase ml-2 tracking-wide">বর্তমান
                                পাসওয়ার্ড</label>
                            <input type="password" name="oldPassword" placeholder="আপনার বর্তমান পাসওয়ার্ড"
                                class="w-full h-15 rounded-2xl bg-slate-50 dark:bg-slate-950 border-none px-6 font-black focus:ring-4 focus:ring-primary/10 transition-all shadow-inner" />
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="space-y-2">
                                <label class="text-xs font-black text-slate-400 uppercase ml-2 tracking-wide">নতুন
                                    পাসওয়ার্ড</label>
                                <input type="password" id="npass" name="password" placeholder="নতুন পাসওয়ার্ড দিন"
                                    class="w-full h-15 rounded-2xl bg-slate-50 dark:bg-slate-950 border-none px-6 font-black focus:ring-4 focus:ring-primary/10 transition-all shadow-inner" />
                            </div>
                            <div class="space-y-2">
                                <label class="text-xs font-black text-slate-400 uppercase ml-2 tracking-wide">নিশ্চিত
                                    করুন</label>
                                <input type="password" id="cpass" placeholder="আবার টাইপ করুন"
                                    class="w-full h-15 rounded-2xl bg-slate-50 dark:bg-slate-950 border-none px-6 font-black focus:ring-4 focus:ring-primary/10 transition-all shadow-inner" />
                            </div>
                        </div>
                        <p id="err-text" class="hidden text-[10px] font-black text-red-500 ml-2">পাসওয়ার্ড দুটি মিলছে
                            না।</p>

                        <button type="submit"
                            class="w-full h-16 bg-slate-900 dark:bg-white dark:text-slate-900 text-white rounded-[1.5rem] font-black text-lg shadow-2xl hover:translate-y-[-2px] active:scale-95 transition-all">
                            Save Changes
                        </button>
                    </div>
                </form>
    </main>

    <script>
        const npass = document.getElementById('npass');
        const cpass = document.getElementById('cpass');
        const err = document.getElementById('err-text');
        const form = document.querySelector('form');

        form.addEventListener('submit', (e) => {
            if (npass.value && npass.value !== cpass.value) {
                e.preventDefault();
                err.classList.remove('hidden');
            }
        });
    </script>
</body>

</html>