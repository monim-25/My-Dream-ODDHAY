<!DOCTYPE html>
<html class="light" lang="bn">

<head>
    <title>‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶≤‡¶ø‡¶ü‡¶ø‡¶ï‡ßç‡¶∏ | ODDHAY</title>
    <%- include('partials/head') %>
</head>

<body class="bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-100 min-h-screen">
    <%- include('partials/nav') %>

        <main class="pt-28 pb-20 px-4 md:px-6 max-w-6xl mx-auto">
            <!-- Header -->
            <div class="mb-10 reveal active">
                <h1 class="text-3xl md:text-4xl font-black mb-2">‡¶Ü‡¶Æ‡¶æ‡¶∞ <span class="text-primary">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶≤‡¶ø‡¶ü‡¶ø‡¶ï‡ßç‡¶∏</span>
                </h1>
                <p class="text-slate-500">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∂‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶Ö‡¶ó‡ßç‡¶∞‡¶ó‡¶§‡¶ø ‡¶è‡¶¨‡¶Ç ‡¶™‡¶æ‡¶∞‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏ ‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£</p>
            </div>

            <!-- Stats Cards -->
            <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-10 reveal active">
                <div class="glass-card p-5 text-center col-span-1">
                    <div class="text-3xl font-black text-primary mb-1">
                        <%= stats.totalQuizzes %>
                    </div>
                    <div class="text-xs text-slate-500 font-semibold">‡¶Æ‡ßã‡¶ü ‡¶ï‡ßÅ‡¶á‡¶ú</div>
                </div>
                <div class="glass-card p-5 text-center col-span-1">
                    <div class="text-3xl font-black text-emerald-500 mb-1">
                        <%= stats.avgScore %>%
                    </div>
                    <div class="text-xs text-slate-500 font-semibold">‡¶ó‡¶°‡¶º ‡¶∏‡ßç‡¶ï‡ßã‡¶∞</div>
                </div>
                <div class="glass-card p-5 text-center col-span-1">
                    <div class="text-3xl font-black text-blue-500 mb-1">
                        <%= stats.totalCourses %>
                    </div>
                    <div class="text-xs text-slate-500 font-semibold">‡¶è‡¶®‡¶∞‡ßã‡¶≤‡ßç‡¶° ‡¶ï‡ßã‡¶∞‡ßç‡¶∏</div>
                </div>
                <div class="glass-card p-5 text-center col-span-1">
                    <div class="text-3xl font-black text-purple-500 mb-1">
                        <%= stats.completedLessons %>
                    </div>
                    <div class="text-xs text-slate-500 font-semibold">‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶≤‡ßá‡¶∏‡¶®</div>
                </div>
                <div class="glass-card p-5 text-center col-span-2 md:col-span-1">
                    <div class="text-3xl font-black text-orange-500 mb-1">
                        <%= stats.daysLearning %>
                    </div>
                    <div class="text-xs text-slate-500 font-semibold">‡¶¶‡¶ø‡¶® ‡¶ß‡¶∞‡ßá ‡¶∂‡¶ø‡¶ñ‡¶õ‡ßá‡¶®</div>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-6 mb-6">
                <!-- Weekly Activity Chart -->
                <div class="glass-card p-6 reveal active">
                    <h2 class="text-lg font-black mb-6 flex items-center gap-2">
                        <span class="material-symbols-outlined text-primary">bar_chart</span>
                        ‡¶∏‡¶æ‡¶™‡ßç‡¶§‡¶æ‡¶π‡¶ø‡¶ï ‡¶ï‡¶æ‡¶∞‡ßç‡¶Ø‡¶ï‡ßç‡¶∞‡¶Æ
                    </h2>
                    <% if (weeklyActivity.length> 0) { %>
                        <div class="flex items-end gap-2 h-40">
                            <% const maxCount=Math.max(...weeklyActivity.map(d=> d.count), 1); %>
                                <% weeklyActivity.forEach(function(day) { %>
                                    <div class="flex-1 flex flex-col items-center gap-1">
                                        <div class="w-full rounded-t-lg bg-primary/20 hover:bg-primary/40 transition-all relative group"
                                            style="height: <%= Math.max((day.count / maxCount) * 130, 8) %>px">
                                            <% if (day.count> 0) { %>
                                                <div
                                                    class="absolute -top-7 left-1/2 -translate-x-1/2 bg-slate-800 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap">
                                                    <%= day.count %> ‡¶ï‡ßÅ‡¶á‡¶ú
                                                </div>
                                                <% } %>
                                        </div>
                                        <span class="text-xs text-slate-500 font-semibold">
                                            <%= day.day %>
                                        </span>
                                    </div>
                                    <% }); %>
                        </div>
                        <% } else { %>
                            <div class="text-center py-10 text-slate-400">
                                <span class="material-symbols-outlined text-5xl mb-2 block opacity-30">bar_chart</span>
                                <p class="text-sm">‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶ï‡¶æ‡¶∞‡ßç‡¶Ø‡¶ï‡ßç‡¶∞‡¶Æ ‡¶®‡ßá‡¶á</p>
                            </div>
                            <% } %>
                </div>

                <!-- Subject Performance -->
                <div class="glass-card p-6 reveal active">
                    <h2 class="text-lg font-black mb-6 flex items-center gap-2">
                        <span class="material-symbols-outlined text-primary">school</span>
                        ‡¶¨‡¶ø‡¶∑‡¶Ø‡¶º‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï ‡¶™‡¶æ‡¶∞‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏
                    </h2>
                    <% const subjects=Object.entries(subjectPerformance); %>
                        <% if (subjects.length> 0) { %>
                            <div class="space-y-4">
                                <% subjects.slice(0, 5).forEach(function([subject, data]) { %>
                                    <% const pct=Math.round((data.score / data.total) * 100); %>
                                        <div>
                                            <div class="flex justify-between items-center mb-1">
                                                <span class="text-sm font-bold">
                                                    <%= subject %>
                                                </span>
                                                <span
                                                    class="text-sm font-black <%= pct >= 70 ? 'text-emerald-500' : pct >= 50 ? 'text-yellow-500' : 'text-red-500' %>">
                                                    <%= pct %>%
                                                </span>
                                            </div>
                                            <div
                                                class="h-2.5 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden">
                                                <div class="h-full rounded-full transition-all duration-1000 <%= pct >= 70 ? 'bg-emerald-500' : pct >= 50 ? 'bg-yellow-500' : 'bg-red-500' %>"
                                                    style="width: <%= pct %>%"></div>
                                            </div>
                                            <div class="text-xs text-slate-400 mt-1">
                                                <%= data.count %> ‡¶ü‡¶ø ‡¶ï‡ßÅ‡¶á‡¶ú
                                            </div>
                                        </div>
                                        <% }); %>
                            </div>
                            <% } else { %>
                                <div class="text-center py-10 text-slate-400">
                                    <span class="material-symbols-outlined text-5xl mb-2 block opacity-30">quiz</span>
                                    <p class="text-sm">‡¶ï‡ßÅ‡¶á‡¶ú ‡¶¶‡¶ø‡¶≤‡ßá ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¨‡¶ø‡¶∑‡¶Ø‡¶º‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï ‡¶´‡¶≤‡¶æ‡¶´‡¶≤ ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá</p>
                                    <a href="/exams" class="mt-4 inline-block btn-primary !py-2 !px-4 !text-sm">‡¶ï‡ßÅ‡¶á‡¶ú
                                        ‡¶¶‡¶ø‡¶®</a>
                                </div>
                                <% } %>
                </div>
            </div>

            <!-- Recent Quiz Results -->
            <div class="glass-card p-6 reveal active">
                <h2 class="text-lg font-black mb-6 flex items-center gap-2">
                    <span class="material-symbols-outlined text-primary">history</span>
                    ‡¶∏‡¶æ‡¶Æ‡ßç‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï ‡¶ï‡ßÅ‡¶á‡¶ú ‡¶´‡¶≤‡¶æ‡¶´‡¶≤
                </h2>
                <% if (recentQuizzes.length> 0) { %>
                    <div class="space-y-3">
                        <% recentQuizzes.forEach(function(r) { %>
                            <% const pct=Math.round((r.score / (r.total || 1)) * 100); %>
                                <div
                                    class="flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-800/50 rounded-2xl">
                                    <div class="flex items-center gap-3">
                                        <div
                                            class="size-10 rounded-xl flex items-center justify-center font-black text-sm
                                <%= pct >= 70 ? 'bg-emerald-100 text-emerald-600' : pct >= 50 ? 'bg-yellow-100 text-yellow-600' : 'bg-red-100 text-red-600' %>">
                                            <%= pct %>%
                                        </div>
                                        <div>
                                            <div class="font-bold text-sm">
                                                <%= r.quiz?.title || '‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶ï‡ßÅ‡¶á‡¶ú' %>
                                            </div>
                                            <div class="text-xs text-slate-400">
                                                <%= new Date(r.date).toLocaleDateString('bn-BD', {day: 'numeric' ,
                                                    month: 'short' , year: 'numeric' }) %>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <div class="font-black text-lg">
                                            <%= r.score %>/<%= r.total %>
                                        </div>
                                        <div class="text-xs text-slate-400">‡¶∏‡ßç‡¶ï‡ßã‡¶∞</div>
                                    </div>
                                </div>
                                <% }); %>
                    </div>
                    <% } else { %>
                        <div class="text-center py-16 text-slate-400">
                            <span class="material-symbols-outlined text-6xl mb-4 block opacity-20">quiz</span>
                            <h3 class="text-xl font-bold mb-2 opacity-50">‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶ï‡ßÅ‡¶á‡¶ú ‡¶¶‡ßá‡¶®‡¶®‡¶ø</h3>
                            <p class="text-sm mb-6">‡¶ï‡ßÅ‡¶á‡¶ú ‡¶¶‡¶ø‡¶≤‡ßá ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶´‡¶≤‡¶æ‡¶´‡¶≤ ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§</p>
                            <a href="/exams" class="btn-primary !py-3 !px-8">
                                <span class="material-symbols-outlined">quiz</span>
                                ‡¶ï‡ßÅ‡¶á‡¶ú ‡¶¶‡¶ø‡¶®
                            </a>
                        </div>
                        <% } %>
            </div>

            <!-- Performance Insight -->
            <% if (stats.totalQuizzes> 0) { %>
                <div
                    class="mt-6 glass-card p-6 reveal active border-l-4 <%= stats.avgScore >= 70 ? 'border-emerald-500' : stats.avgScore >= 50 ? 'border-yellow-500' : 'border-red-500' %>">
                    <div class="flex items-start gap-4">
                        <span
                            class="material-symbols-outlined text-3xl <%= stats.avgScore >= 70 ? 'text-emerald-500' : stats.avgScore >= 50 ? 'text-yellow-500' : 'text-red-500' %>">
                            <%= stats.avgScore>= 70 ? 'emoji_events' : stats.avgScore >= 50 ? 'trending_up' : 'school'
                                %>
                        </span>
                        <div>
                            <h3 class="font-black text-lg mb-1">
                                <% if (stats.avgScore>= 70) { %>‡¶ö‡¶Æ‡ßé‡¶ï‡¶æ‡¶∞ ‡¶™‡¶æ‡¶∞‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏! üéâ
                                    <% } else if (stats.avgScore>= 50) { %>‡¶≠‡¶æ‡¶≤‡ßã ‡¶ï‡¶∞‡¶õ‡ßá‡¶®, ‡¶Ü‡¶∞‡¶ì ‡¶â‡¶®‡ßç‡¶®‡¶§‡¶ø ‡¶∏‡¶Æ‡ßç‡¶≠‡¶¨!
                                        <% } else { %>‡¶Ü‡¶∞‡¶ì ‡¶¨‡ßá‡¶∂‡¶ø ‡¶Ö‡¶®‡ßÅ‡¶∂‡ßÄ‡¶≤‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®<% } %>
                            </h3>
                            <p class="text-slate-500 text-sm">
                                <% if (stats.avgScore>= 70) { %>
                                    ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ó‡¶°‡¶º ‡¶∏‡ßç‡¶ï‡ßã‡¶∞ <%= stats.avgScore %>%‡•§ ‡¶è‡¶á ‡¶ß‡¶æ‡¶∞‡¶æ ‡¶¨‡¶ú‡¶æ‡¶Ø‡¶º ‡¶∞‡¶æ‡¶ñ‡ßÅ‡¶®!
                                        <% } else if (stats.avgScore>= 50) { %>
                                            ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ó‡¶°‡¶º ‡¶∏‡ßç‡¶ï‡ßã‡¶∞ <%= stats.avgScore %>%‡•§ ‡¶®‡¶ø‡¶Ø‡¶º‡¶Æ‡¶ø‡¶§ ‡¶Ö‡¶®‡ßÅ‡¶∂‡ßÄ‡¶≤‡¶® ‡¶ï‡¶∞‡¶≤‡ßá ‡¶Ü‡¶∞‡¶ì ‡¶≠‡¶æ‡¶≤‡ßã ‡¶ï‡¶∞‡¶¨‡ßá‡¶®‡•§
                                                <% } else { %>
                                                    ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ó‡¶°‡¶º ‡¶∏‡ßç‡¶ï‡ßã‡¶∞ <%= stats.avgScore %>%‡•§ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¶‡¶ø‡¶® ‡¶è‡¶ï‡¶ü‡ßÅ ‡¶è‡¶ï‡¶ü‡ßÅ ‡¶ï‡¶∞‡ßá
                                                        ‡¶™‡¶°‡¶º‡ßÅ‡¶®‡•§
                                                        <% } %>
                            </p>
                        </div>
                    </div>
                </div>
                <% } %>
        </main>

        <%- include('partials/footer') %>
</body>

</html>