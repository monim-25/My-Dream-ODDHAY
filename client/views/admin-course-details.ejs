<!DOCTYPE html>
<html class="light" lang="bn">

<head>
    <title>কোর্স ম্যানেজমেন্ট | ODDHAY</title>
    <%- include('partials/head') %>
        <style>
            .admin-sidebar {
                width: 280px;
                height: 100vh;
                position: fixed;
                left: 0;
                top: 0;
                background: #fff;
                border-right: 1px solid rgba(0, 0, 0, 0.03);
                z-index: 100;
                padding: 2rem;
            }

            .dark .admin-sidebar {
                background: #101922;
                border-right: 1px solid rgba(255, 255, 255, 0.03);
            }

            .admin-main {
                margin-left: 280px;
                padding: 40px;
                min-height: 100vh;
            }

            @media (max-width: 1024px) {
                .admin-sidebar {
                    display: none;
                }

                .admin-main {
                    margin-left: 0;
                    padding: 24px;
                }
            }

            .chapter-card {
                background: white;
                border-radius: 2.5rem;
                border: 1px solid rgba(0, 0, 0, 0.03);
                overflow: hidden;
                transition: all 0.3s ease;
            }

            .dark .chapter-card {
                background: #1e293b;
                border-color: rgba(255, 255, 255, 0.03);
            }
        </style>
</head>

<body class="bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-100">

    <aside class="admin-sidebar hidden lg:flex flex-col">
        <%- include('admin/sidebar_content', { active: 'courses' }) %>
    </aside>

    <main class="admin-main">
        <header class="flex justify-between items-center mb-16">
            <div class="flex items-center gap-6">
                <a href="/admin/teacher"
                    class="size-12 rounded-2xl bg-white dark:bg-slate-800 flex items-center justify-center shadow-sm border border-slate-100 dark:border-slate-700 hover:text-primary transition-all">
                    <span class="material-symbols-outlined">arrow_back</span>
                </a>
                <div>
                    <h1 class="h2-section !text-[24px] uppercase tracking-tight">
                        <%= course.title %>
                    </h1>
                    <p class="body-main !text-xs opacity-50 font-bold uppercase tracking-wider mt-1">Resource Management
                    </p>
                </div>
            </div>
            <div class="flex items-center gap-4">
                <div
                    class="px-4 py-2 rounded-xl bg-primary/5 text-primary text-xs font-black uppercase tracking-widest border border-primary/10">
                    <%= course.classLevel %>
                </div>
            </div>
        </header>

        <div class="space-y-12">
            <!-- Add Chapter -->
            <section
                class="card-smart !p-10 shadow-sm border-dashed border-2 border-slate-200 dark:border-slate-800 bg-transparent">
                <div class="flex items-center gap-4 mb-8">
                    <div class="size-10 rounded-xl bg-primary/10 text-primary flex items-center justify-center">
                        <span class="material-symbols-outlined">create_new_folder</span>
                    </div>
                    <h3 class="h3-card !text-lg">নতুন চ্যাপ্টার যোগ করুন</h3>
                </div>
                <form action="/admin/course/<%= course._id %>/add-chapter" method="POST"
                    class="flex flex-col md:flex-row gap-4">
                    <input type="text" name="title" placeholder="চ্যাপ্টারের নাম (উদা: অধ্যায় ১: ভেক্টর)"
                        class="flex-1 px-6 h-14 rounded-2xl bg-white dark:bg-slate-900 border-none focus:ring-1 focus:ring-primary font-bold text-sm shadow-sm"
                        required>
                    <button type="submit" class="btn-primary !h-14 !px-10 !rounded-2xl">চ্যাপ্টার তৈরি করুন</button>
                </form>
            </section>

            <!-- Chapters List -->
            <% (course.chapters || []).forEach(chapter=> { %>
                <div class="chapter-card shadow-sm hover:shadow-xl transition-all">
                    <div
                        class="px-10 py-8 bg-slate-50 dark:bg-slate-800/40 border-b border-slate-100 dark:border-slate-800/50 flex justify-between items-center">
                        <h3 class="h3-card !text-xl flex items-center gap-4">
                            <span class="size-2 rounded-full bg-primary"></span>
                            <%= chapter.title %>
                        </h3>
                        <div class="flex gap-2">
                            <form action="/admin/course/<%= course._id %>/chapter/<%= chapter._id %>/delete"
                                method="POST" onsubmit="return confirm('নিশ্চিত তো?')">
                                <button type="submit"
                                    class="size-10 rounded-xl bg-red-500/5 text-red-500 flex items-center justify-center hover:bg-red-500 hover:text-white transition-all">
                                    <span class="material-symbols-outlined text-xl">delete</span>
                                </button>
                            </form>
                        </div>
                    </div>

                    <div class="p-10 grid grid-cols-1 md:grid-cols-3 gap-10">
                        <!-- Recorded Videos -->
                        <div class="space-y-8">
                            <h4 class="caption !text-[11px] flex items-center gap-3 text-primary">
                                <span class="material-symbols-outlined !text-lg">video_library</span> রেকর্ড ক্লাস
                            </h4>
                            <form action="/admin/course/<%= course._id %>/chapter/<%= chapter._id %>/add-recorded"
                                method="POST" enctype="multipart/form-data" class="space-y-3">
                                <input type="text" name="title" placeholder="লেসন টাইটেল"
                                    class="w-full h-11 px-4 rounded-xl bg-slate-50 dark:bg-slate-900 border-none focus:ring-1 focus:ring-primary font-bold text-xs"
                                    required>
                                <div class="relative group">
                                    <input type="file" name="video" accept="video/*"
                                        class="absolute inset-0 opacity-0 cursor-pointer z-10" required>
                                    <div
                                        class="h-11 border-dashed border border-slate-200 dark:border-slate-700 rounded-xl flex items-center justify-center gap-2 text-xs font-bold text-slate-400 group-hover:border-primary transition-all">
                                        <span class="material-symbols-outlined text-sm">cloud_upload</span> ভিডিও ফাইল
                                    </div>
                                </div>
                                <button type="submit"
                                    class="btn-primary w-full !h-10 !text-[10px] !rounded-xl !bg-slate-900 dark:!bg-primary">আপলোড
                                    করুন</button>
                            </form>
                            <div class="space-y-2">
                                <% (chapter.recordedClasses || []).forEach(v=> { %>
                                    <div
                                        class="flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-900 rounded-2xl border border-slate-100 dark:border-slate-800">
                                        <span class="body-main !text-xs font-bold truncate pr-4">
                                            <%= v.title %>
                                        </span>
                                        <span class="material-symbols-outlined text-primary text-sm">check_circle</span>
                                    </div>
                                    <% }) %>
                            </div>
                        </div>

                        <!-- Live Classes -->
                        <div class="space-y-8">
                            <h4 class="caption !text-[11px] flex items-center gap-3 text-rose-500">
                                <span class="material-symbols-outlined !text-lg">live_tv</span> লাইভ লিঙ্ক
                            </h4>
                            <form action="/admin/course/<%= course._id %>/chapter/<%= chapter._id %>/add-live"
                                method="POST" class="space-y-3">
                                <input type="text" name="title" placeholder="টপিক"
                                    class="w-full h-11 px-4 rounded-xl bg-slate-50 dark:bg-slate-900 border-none focus:ring-1 focus:ring-primary font-bold text-xs"
                                    required>
                                <input type="url" name="meetingUrl" placeholder="Zoom/Google Meet Link"
                                    class="w-full h-11 px-4 rounded-xl bg-slate-50 dark:bg-slate-900 border-none focus:ring-1 focus:ring-primary font-bold text-xs"
                                    required>
                                <button type="submit"
                                    class="btn-primary w-full !h-10 !text-[10px] !rounded-xl !bg-slate-900 dark:!bg-rose-500">লিঙ্ক
                                    সেভ করুন</button>
                            </form>
                        </div>

                        <!-- Notes -->
                        <div class="space-y-8">
                            <h4 class="caption !text-[11px] flex items-center gap-3 text-amber-500">
                                <span class="material-symbols-outlined !text-lg">description</span> লেকচার নোটস
                            </h4>
                            <form action="/admin/course/<%= course._id %>/chapter/<%= chapter._id %>/add-note"
                                method="POST" enctype="multipart/form-data" class="space-y-3">
                                <input type="text" name="title" placeholder="নোটের নাম"
                                    class="w-full h-11 px-4 rounded-xl bg-slate-50 dark:bg-slate-900 border-none focus:ring-1 focus:ring-primary font-bold text-xs"
                                    required>
                                <div class="relative group">
                                    <input type="file" name="note" accept=".pdf,.doc,.docx"
                                        class="absolute inset-0 opacity-0 cursor-pointer z-10" required>
                                    <div
                                        class="h-11 border-dashed border border-slate-200 dark:border-slate-700 rounded-xl flex items-center justify-center gap-2 text-xs font-bold text-slate-400 group-hover:border-primary transition-all">
                                        <span class="material-symbols-outlined text-sm">picture_as_pdf</span> PDF/Doc
                                        ফাইল
                                    </div>
                                </div>
                                <button type="submit"
                                    class="btn-primary w-full !h-10 !text-[10px] !rounded-xl !bg-slate-900 dark:!bg-amber-500">ফাইল
                                    আপলোড</button>
                            </form>
                            <div class="space-y-2">
                                <% (chapter.notes || []).forEach(n=> { %>
                                    <div
                                        class="flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-900 rounded-2xl border border-slate-100 dark:border-slate-800">
                                        <span class="body-main !text-xs font-bold truncate pr-4">
                                            <%= n.title %>
                                        </span>
                                        <span
                                            class="material-symbols-outlined text-amber-500 text-sm">description</span>
                                    </div>
                                    <% }) %>
                            </div>
                        </div>
                    </div>
                </div>
                <% }) %>
        </div>
    </main>

    <%- include('partials/nav_script') %>
</body>

</html>